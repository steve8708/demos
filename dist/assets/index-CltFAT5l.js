import{M as At,O as me,R as n,_ as _e,m as Ct,o as X,az as It,r as q,ay as Oe,p as O,f as _t,$ as jt,Y as Qe,br as Ie,ax as kt,N as Pt,a$ as ft,t as ve,bc as Ft,aL as ht,a7 as He,ao as St,n as Nt,c5 as Rt,c6 as Dt,aR as zt,u as qt,w as Vt,c as Mt}from"./index-DLMN1afU.js";import{u as Ue,t as lt,T as Gt}from"./dismiss-button-C-DcIRP0.js";import{D as We,u as Kt}from"./index-CgWRm0rq.js";import{V as Ht,P as Wt}from"./use-select-CGMio23-.js";import{u as Bt,s as $t,I as Qt}from"./internal-B7gVIJJh.js";import{u as Ut,a as Yt,A as Jt,b as Xt,c as Zt,I as eo}from"./internal-Co3skvOO.js";import{I as st}from"./internal-BPx0L9tT.js";import{I as Ye}from"./internal-BfYk3OGg.js";import{I as ut}from"./internal-BWpMHlT2.js";function to(e,o){let t=0,l=null;for(const i of e)(i.propertyLabel.length>=t&&je(o,i.propertyLabel)||i.propertyLabel.length>t&&je(o.toLowerCase(),i.propertyLabel.toLowerCase()))&&(t=i.propertyLabel.length,l=i);return l}function dt(e,o){o=o.toLowerCase();let t=0,l=null;for(const i of e)i.length>t&&je(o,i.toLowerCase())&&(t=i.length,l=i);return l}function oo(e,o){if(o.trim().length===0)return"";for(const t of e)if(je(t.toLowerCase(),o.toLowerCase()))return o;return null}function ro({property:e,operator:o,value:t},l){var i,u;const p=e==null?void 0:e.getTokenType(o),d=l.filter(a=>a.property===e),r=a=>a===null?p==="enum"?[]:null:p==="enum"&&!Array.isArray(a)?[a]:a,s={propertyKey:e==null?void 0:e.propertyKey,operator:o,value:r(t)};for(const a of d){if(a.label&&a.label===t||!a.label&&a.value===t)return{propertyKey:e==null?void 0:e.propertyKey,operator:o,value:r(a.value)};typeof t=="string"&&t.toLowerCase()===((u=(i=a.label)!==null&&i!==void 0?i:a.value)!==null&&u!==void 0?u:"").toLowerCase()&&(s.value=r(a.value))}return s}function ct(e){let o=0;for(let t=0;t<e.length&&e[t]===" ";t++)o++;return e.slice(o)}function no(e){return e[0]===" "?e.slice(1):e}function pt(e,o){const t=e.indexOf(o)+o.length,l=e.slice(t);return no(l)}function je(e,o){return e.indexOf(o)===0}function we(e){const o=[];for(const t of e)if("operator"in t)o.push(t);else for(const l of t.tokens)"operator"in l&&o.push(l);return o}function ao(e={}){var o;const t=At("property-filter"),l=t("i18nStrings.allPropertiesLabel",e==null?void 0:e.allPropertiesLabel),i=t("i18nStrings.operationAndText",e==null?void 0:e.operationAndText),u=t("i18nStrings.operationOrText",e==null?void 0:e.operationOrText),p=(o=t("i18nStrings.formatToken",e.formatToken,r=>s=>r({token__propertyLabel:s.propertyLabel,token__operator:io(s.operator),token__value:s.value})))!==null&&o!==void 0?o:r=>`${r.propertyLabel} ${r.operator} ${r.value}`;function d(r){var s,a,c;let m=(s=r.property)===null||s===void 0?void 0:s.getValueFormatter(r.operator);!m&&((a=r.property)===null||a===void 0?void 0:a.getTokenType(r.operator))==="enum"&&(m=k=>Array.isArray(k)?k.join(", "):k);const v=r.property?r.property.propertyLabel:l??"",_=m?m(r.value):r.value;return{propertyKey:(c=r.property)===null||c===void 0?void 0:c.propertyKey,propertyLabel:v,operator:r.operator,value:_}}return Object.assign(Object.assign({},e),{allPropertiesLabel:l,operationAndText:i,operationOrText:u,applyActionText:t("i18nStrings.applyActionText",e==null?void 0:e.applyActionText),cancelActionText:t("i18nStrings.cancelActionText",e==null?void 0:e.cancelActionText),clearFiltersText:t("i18nStrings.clearFiltersText",e==null?void 0:e.clearFiltersText),editTokenHeader:t("i18nStrings.editTokenHeader",e==null?void 0:e.editTokenHeader),groupPropertiesText:t("i18nStrings.groupPropertiesText",e==null?void 0:e.groupPropertiesText),groupValuesText:t("i18nStrings.groupValuesText",e==null?void 0:e.groupValuesText),operatorContainsText:t("i18nStrings.operatorContainsText",e==null?void 0:e.operatorContainsText),operatorDoesNotContainText:t("i18nStrings.operatorDoesNotContainText",e==null?void 0:e.operatorDoesNotContainText),operatorDoesNotEqualText:t("i18nStrings.operatorDoesNotEqualText",e==null?void 0:e.operatorDoesNotEqualText),operatorEqualsText:t("i18nStrings.operatorEqualsText",e==null?void 0:e.operatorEqualsText),operatorGreaterOrEqualText:t("i18nStrings.operatorGreaterOrEqualText",e==null?void 0:e.operatorGreaterOrEqualText),operatorGreaterText:t("i18nStrings.operatorGreaterText",e==null?void 0:e.operatorGreaterText),operatorLessOrEqualText:t("i18nStrings.operatorLessOrEqualText",e==null?void 0:e.operatorLessOrEqualText),operatorLessText:t("i18nStrings.operatorLessText",e==null?void 0:e.operatorLessText),operatorStartsWithText:t("i18nStrings.operatorStartsWithText",e==null?void 0:e.operatorStartsWithText),operatorDoesNotStartWithText:t("i18nStrings.operatorDoesNotStartWithText",e==null?void 0:e.operatorDoesNotStartWithText),operatorText:t("i18nStrings.operatorText",e==null?void 0:e.operatorText),operatorsText:t("i18nStrings.operatorsText",e==null?void 0:e.operatorsText),propertyText:t("i18nStrings.propertyText",e==null?void 0:e.propertyText),tokenLimitShowFewer:t("i18nStrings.tokenLimitShowFewer",e==null?void 0:e.tokenLimitShowFewer),tokenLimitShowMore:t("i18nStrings.tokenLimitShowMore",e==null?void 0:e.tokenLimitShowMore),valueText:t("i18nStrings.valueText",e==null?void 0:e.valueText),tokenEditorTokenRemoveLabel:t("i18nStrings.tokenEditorTokenRemoveLabel",e==null?void 0:e.tokenEditorTokenRemoveLabel),tokenEditorTokenRemoveFromGroupLabel:t("i18nStrings.tokenEditorTokenRemoveFromGroupLabel",e==null?void 0:e.tokenEditorTokenRemoveFromGroupLabel),tokenEditorAddNewTokenLabel:t("i18nStrings.tokenEditorAddNewTokenLabel",e==null?void 0:e.tokenEditorAddNewTokenLabel),tokenEditorAddTokenActionsAriaLabel:t("i18nStrings.tokenEditorAddTokenActionsAriaLabel",e==null?void 0:e.tokenEditorAddTokenActionsAriaLabel),formatToken:r=>{const s=d(r);return Object.assign(Object.assign({},s),{formattedText:p(d(r))})},groupAriaLabel:r=>{var s;const a=we(r.tokens).map(d),c=(s=r.operation==="and"?i:u)!==null&&s!==void 0?s:"";return a.map(m=>p(m)).join(` ${c} `)},groupEditAriaLabel:r=>{var s,a;const c=we(r.tokens).map(k=>d(k)),m=r.operation,v=(s=m==="and"?i:u)!==null&&s!==void 0?s:"",_=t("i18nStrings.groupEditAriaLabel",e.groupEditAriaLabel,k=>()=>k({group__operationLabel:v,group__formattedTokens__length:c.length.toString(),group__formattedTokens0__formattedText:c[0]?p(c[0]):"",group__formattedTokens1__formattedText:c[1]?p(c[1]):"",group__formattedTokens2__formattedText:c[2]?p(c[2]):"",group__formattedTokens3__formattedText:c[3]?p(c[3]):""}));return(a=_==null?void 0:_({operation:m,operationLabel:v,tokens:c}))!==null&&a!==void 0?a:""},removeTokenButtonAriaLabel:r=>{var s;const a=t("i18nStrings.removeTokenButtonAriaLabel",e.removeTokenButtonAriaLabel,c=>()=>c({token__formattedText:p(d(r))}));return(s=a==null?void 0:a(d(r)))!==null&&s!==void 0?s:""},tokenEditorTokenActionsAriaLabel:r=>{var s;const a=t("i18nStrings.tokenEditorTokenActionsAriaLabel",e.tokenEditorTokenActionsAriaLabel,c=>()=>c({token__formattedText:p(d(r))}));return(s=a==null?void 0:a(d(r)))!==null&&s!==void 0?s:""},tokenEditorTokenRemoveAriaLabel:r=>{var s;const a=t("i18nStrings.tokenEditorTokenRemoveAriaLabel",e.tokenEditorTokenRemoveAriaLabel,c=>()=>c({token__formattedText:p(d(r))}));return(s=a==null?void 0:a(d(r)))!==null&&s!==void 0?s:""},tokenEditorAddExistingTokenAriaLabel:r=>{var s;const a=t("i18nStrings.tokenEditorAddExistingTokenAriaLabel",e.tokenEditorAddExistingTokenAriaLabel,c=>()=>c({token__formattedText:p(d(r))}));return(s=a==null?void 0:a(d(r)))!==null&&s!==void 0?s:""},tokenEditorAddExistingTokenLabel:r=>{var s;const a=d(r),c=t("i18nStrings.tokenEditorAddExistingTokenLabel",e.tokenEditorAddExistingTokenLabel,m=>()=>m({token__propertyLabel:a.propertyLabel,token__operator:a.operator,token__value:a.value}));return(s=c==null?void 0:c(d(r)))!==null&&s!==void 0?s:""}})}function Be(e,o){switch(e){case"<":return o.operatorLessText;case"<=":return o.operatorLessOrEqualText;case">":return o.operatorGreaterText;case">=":return o.operatorGreaterOrEqualText;case":":return o.operatorContainsText;case"!:":return o.operatorDoesNotContainText;case"=":return o.operatorEqualsText;case"!=":return o.operatorDoesNotEqualText;case"^":return o.operatorStartsWithText;case"!^":return o.operatorDoesNotStartWithText;default:return""}}function io(e){switch(e){case"=":return"equals";case"!=":return"not_equals";case">":return"greater_than";case">=":return"greater_than_equal";case"<":return"less_than";case"<=":return"less_than_equal";case":":return"contains";case"!:":return"not_contains";case"^":return"starts_with";case"!^":return"not_starts_with";default:return e}}const lo=({query:e,onChange:o,filteringOptions:t,enableTokenGroups:l})=>{const i=a=>{function c(v){return"operator"in v?ro(v,t):Object.assign(Object.assign({},v),{tokens:v.tokens.map(c)})}const m=a.tokens.map(c);l?me(o,{tokens:[],operation:a.operation,tokenGroups:m}):me(o,{tokens:we(m),operation:a.operation})};return{addToken:a=>{i(Object.assign(Object.assign({},e),{tokens:[...e.tokens,a]}))},updateToken:(a,c,m)=>{const _=we([c]).map(y=>y.standaloneIndex).filter(y=>y!==void 0),k=e.tokens.map((y,T)=>T===a?c:y).filter((y,T)=>T===a||!_.includes(T));k.push(...m),i(Object.assign(Object.assign({},e),{tokens:k}))},updateOperation:a=>{i(Object.assign(Object.assign({},e),{operation:a}))},removeToken:a=>{i(Object.assign(Object.assign({},e),{tokens:e.tokens.filter((c,m)=>m!==a)}))},removeAllTokens:()=>{i(Object.assign(Object.assign({},e),{tokens:[]}))}}},ke=e=>{const{operators:o=[],defaultOperator:t}=e,l=["=","!=",":","!:","^","!^",">=","<=","<",">"],i=new Set([t,...o]);return l.filter(u=>i.has(u))},Ge=(e,o,t)=>{const l=to(o,e);if(!l){if(!t.disabled){const r=t.operators.indexOf("!:")>=0?["!",...t.operators]:t.operators,s=dt(r,e);if(s)return{step:"free-text",operator:s==="!"?"!:":s,value:pt(e,s)}}return{step:"free-text",value:e}}const i=ke(l),u=e.substring(l.propertyLabel.length),p=dt(i,ct(u));if(p)return{step:"property",property:l,operator:p,value:pt(u,p)};const d=oo(i,ct(u));return d!==null?{step:"operator",property:l,operatorPrefix:d}:{step:"free-text",value:e}},so=(e,o="=",t,l)=>{var i;const u={label:(i=t.groupValuesText)!==null&&i!==void 0?i:"",options:[]},p={};return e.forEach(d=>{const r=d.property;if(!r||ke(r).indexOf(o)===-1)return;if(r.propertyGroup&&!p[r.propertyGroup]){const a=l.reduce((c,m)=>m.group===r.propertyGroup?m.values:c,"");p[r.propertyGroup]={label:a,options:[]}}(r.propertyGroup?p[r.propertyGroup]:u).options.push({value:r.propertyLabel+" "+(o||"=")+" "+d.value,label:d.label,__labelPrefix:r.propertyLabel+" "+(o||"=")})}),[u,...Object.keys(p).map(d=>p[d])]},mt=e=>({value:e.propertyLabel,label:e.propertyLabel,keepOpenOnSelect:!0});function $e(e,o,t,l){var i;const u={label:(i=t.groupPropertiesText)!==null&&i!==void 0?i:"",options:[]},p={};e.forEach(s=>{const{propertyGroup:a}=s;let c=u;if(a){if(!p[a]){const m=o.reduce((v,_)=>_.group===a?_.properties:v,"");p[a]={options:[],label:m}}c=p[a]}c.options.push(l(s))});const d=u.options.length?[u]:[],r=Object.keys(p).map(s=>p[s]);return[...d,...r]}const uo=(e,o,t,l,i)=>{switch(e.step){case"property":{const{propertyLabel:u,groupValuesLabel:p}=e.property,d=t.filter(r=>r.property===e.property);return{filterText:e.value,options:[{options:d.map(({label:r,value:s})=>({value:u+" "+e.operator+" "+s,label:r,__labelPrefix:u+" "+e.operator})),label:p}]}}case"operator":return{filterText:e.property.propertyLabel+" "+e.operatorPrefix,options:[...$e(o,l,i,mt),{options:ke(e.property).map(u=>({value:e.property.propertyLabel+" "+u+" ",label:e.property.propertyLabel+" "+u,description:Be(u,i),keepOpenOnSelect:!0})),label:i.operatorsText}]};case"free-text":{const u=!!e.value,p=!(e.step==="free-text"&&e.operator==="!:");return{filterText:e.value,options:[...p?$e(o,l,i,mt):[],...u?so(t,e.operator,i,l):[]]}}}},co=n.forwardRef((e,o)=>{var{options:t,filteringType:l,ariaLabel:i,selectedOptions:u,deselectAriaLabel:p,virtualScroll:d,filteringText:r=""}=e,s=_e(e,["options","filteringType","ariaLabel","selectedOptions","deselectAriaLabel","virtualScroll","filteringText"]);const a=Ct(s),c=X("multiselect-ariaLabel-"),m=X("multiselect-footer-"),v=Bt(Object.assign({options:t,selectedOptions:u,filteringType:l,disabled:!1,deselectAriaLabel:p,controlId:a.controlId,ariaLabelId:c,footerId:m,filteringValue:r,externalRef:o,keepOpen:!0,embedded:!0},s)),_=d?Ht:Wt,k=v.dropdownStatus;return n.createElement("div",{className:$t.embedded},n.createElement(_,{menuProps:v.getMenuProps(),getOptionProps:v.getOptionProps,filteredOptions:v.filteredOptions,filteringValue:r,ref:v.scrollToIndex,hasDropdownStatus:k.content!==null,checkboxes:!0,useInteractiveGroups:!0,screenReaderContent:v.announcement,highlightType:v.highlightType}),k.content&&n.createElement(We,{content:k.content,id:m}),n.createElement(It,{id:c},i))});function Je(e,o=""){if(!o)return e;const t=[];for(const l of e)if(po(l)){const i=Je(l.options,o);i.length>0&&t.push(Object.assign(Object.assign({},l),{options:i}))}else mo(l,o)&&t.push(l);return t}function po(e){return"options"in e}function mo(e,o){var t,l;o=o.toLowerCase();const i=((t=e.label)!==null&&t!==void 0?t:"").toLowerCase(),u=(l=e.__labelPrefix)!==null&&l!==void 0?l:"",p=(e.value?e.value.slice(u.length):"").toLowerCase();return i.indexOf(o)!==-1||p.indexOf(o)!==-1}const Le=(e,o,t,l,i)=>{const u=q.useRef(!1),p=()=>{u.current=!0},d=a=>{var c;me(e,Object.assign(Object.assign({},a),{filteringText:(c=l??a.filteringText)!==null&&c!==void 0?c:"",filteringProperty:t,filteringOperator:i})),u.current=!1};return{onBlur:p,onFocus:()=>{u.current&&d({firstPage:!0,samePage:!1,filteringText:o})},onLoadItems:({detail:a})=>d(a)}},b={root:"awsui_root_1wzqe_10j2h_145","search-field":"awsui_search-field_1wzqe_10j2h_177","input-wrapper":"awsui_input-wrapper_1wzqe_10j2h_184",tokens:"awsui_tokens_1wzqe_10j2h_198","token-operator":"awsui_token-operator_1wzqe_10j2h_203","property-editor":"awsui_property-editor_1wzqe_10j2h_207","property-editor-header":"awsui_property-editor-header_1wzqe_10j2h_210","property-editor-header-enum":"awsui_property-editor-header-enum_1wzqe_10j2h_223","property-editor-form":"awsui_property-editor-form_1wzqe_10j2h_238","property-editor-cancel":"awsui_property-editor-cancel_1wzqe_10j2h_243","property-editor-actions":"awsui_property-editor-actions_1wzqe_10j2h_246","property-editor-enum":"awsui_property-editor-enum_1wzqe_10j2h_254","token-editor":"awsui_token-editor_1wzqe_10j2h_259","token-editor-form":"awsui_token-editor-form_1wzqe_10j2h_266","token-editor-field-property":"awsui_token-editor-field-property_1wzqe_10j2h_269","token-editor-field-operator":"awsui_token-editor-field-operator_1wzqe_10j2h_272","token-editor-field-value":"awsui_token-editor-field-value_1wzqe_10j2h_275","token-editor-multiselect-wrapper":"awsui_token-editor-multiselect-wrapper_1wzqe_10j2h_278","token-editor-multiselect-wrapper-inner":"awsui_token-editor-multiselect-wrapper-inner_1wzqe_10j2h_283","token-editor-cancel":"awsui_token-editor-cancel_1wzqe_10j2h_287","token-editor-submit":"awsui_token-editor-submit_1wzqe_10j2h_290","token-editor-actions":"awsui_token-editor-actions_1wzqe_10j2h_293","token-editor-grid":"awsui_token-editor-grid_1wzqe_10j2h_302","token-editor-grid-group":"awsui_token-editor-grid-group_1wzqe_10j2h_336","token-editor-narrow":"awsui_token-editor-narrow_1wzqe_10j2h_339","token-editor-supports-groups":"awsui_token-editor-supports-groups_1wzqe_10j2h_348","token-editor-grid-header":"awsui_token-editor-grid-header_1wzqe_10j2h_352","token-editor-grid-cell":"awsui_token-editor-grid-cell_1wzqe_10j2h_358","token-editor-add-token":"awsui_token-editor-add-token_1wzqe_10j2h_367","custom-content-wrapper":"awsui_custom-content-wrapper_1wzqe_10j2h_371","custom-control":"awsui_custom-control_1wzqe_10j2h_375",input:"awsui_input_1wzqe_10j2h_184",results:"awsui_results_1wzqe_10j2h_383","token-trigger":"awsui_token-trigger_1wzqe_10j2h_388","remove-all":"awsui_remove-all_1wzqe_10j2h_393","custom-filter-actions":"awsui_custom-filter-actions_1wzqe_10j2h_395",constraint:"awsui_constraint_1wzqe_10j2h_399"},M={"filtering-token":"awsui_filtering-token_1heb1_1ayd6_5","filtering-token-dismiss-button":"awsui_filtering-token-dismiss-button_1heb1_1ayd6_9","filtering-token-select":"awsui_filtering-token-select_1heb1_1ayd6_13","filtering-token-content":"awsui_filtering-token-content_1heb1_1ayd6_17","filtering-token-inner":"awsui_filtering-token-inner_1heb1_1ayd6_21","filtering-token-inner-dismiss-button":"awsui_filtering-token-inner-dismiss-button_1heb1_1ayd6_25","filtering-token-inner-select":"awsui_filtering-token-inner-select_1heb1_1ayd6_29","filtering-token-inner-content":"awsui_filtering-token-inner-content_1heb1_1ayd6_33","filtering-token-edit-button":"awsui_filtering-token-edit-button_1heb1_1ayd6_37","token-editor-field-property":"awsui_token-editor-field-property_1heb1_1ayd6_41","token-editor-field-operator":"awsui_token-editor-field-operator_1heb1_1ayd6_45","token-editor-field-value":"awsui_token-editor-field-value_1heb1_1ayd6_49","token-editor-token-remove-actions":"awsui_token-editor-token-remove-actions_1heb1_1ayd6_53","token-editor-token-add-actions":"awsui_token-editor-token-add-actions_1heb1_1ayd6_57","token-editor-cancel":"awsui_token-editor-cancel_1heb1_1ayd6_61","token-editor-submit":"awsui_token-editor-submit_1heb1_1ayd6_65","property-editor-cancel":"awsui_property-editor-cancel_1heb1_1ayd6_69","property-editor-submit":"awsui_property-editor-submit_1heb1_1ayd6_73"};function vo({property:e,operator:o,filter:t,value:l,onChange:i,operatorForm:u}){const p=X();return n.createElement("div",{className:b["property-editor"]},n.createElement("div",{className:b["property-editor-header"],id:p},e.groupValuesLabel),n.createElement("div",{className:b["property-editor-form"]},n.createElement(_t.Provider,{value:{ariaLabelledby:p}},u({value:l,onChange:i,operator:o,filter:t}))))}function go({property:e,filter:o,value:t,onChange:l,asyncProps:i,filteringOptions:u,onLoadItems:p}){const d=u.filter(m=>{var v;return((v=m.property)===null||v===void 0?void 0:v.propertyKey)===e.propertyKey}).map(({label:m,value:v})=>({label:m,value:v})),r=Le(p,"",e.externalProperty),s=t?Array.isArray(t)?t:[t]:[],a=d.filter(m=>s.includes(m.value)),c=Je(d,o);return n.createElement("div",{className:O(b["property-editor"],b["property-editor-enum"])},c.length===0&&n.createElement("div",{className:b["property-editor-header-enum"]},n.createElement(jt,{checked:!1,readOnly:!0}),e.groupValuesLabel),n.createElement(co,Object.assign({filteringType:"manual",selectedOptions:a,onChange:m=>l(m.detail.selectedOptions.map(v=>v.value)),options:c.length>0?[{options:c,label:e.groupValuesLabel}]:[],filteringText:o,ariaLabel:e.groupValuesLabel,statusType:"finished",noMatch:i.empty},r,i)))}function bo({property:e,operator:o,value:t,onCancel:l,onSubmit:i,i18nStrings:u}){const p=()=>i({property:e,operator:o,value:t});return n.createElement("div",{className:b["property-editor-actions"]},n.createElement(Oe,{variant:"link",className:O(b["property-editor-cancel"],M["property-editor-cancel"]),onClick:l},u.cancelActionText),n.createElement(Oe,{className:M["property-editor-submit"],onClick:p},u.applyActionText))}const _o=300,ko=200,fo=n.forwardRef((e,o)=>{var t;const{value:l,onChange:i,onFocus:u,onBlur:p,onLoadItems:d,options:r,statusType:s="finished",placeholder:a,disabled:c,ariaLabel:m,enteredTextLabel:v,onKeyDown:_,virtualScroll:k,expandToViewport:y,customForm:T,filterText:F,onOptionClick:V,hideEnteredTextOption:A,searchResultsId:g,onCloseDropdown:w}=e,C=_e(e,["value","onChange","onFocus","onBlur","onLoadItems","options","statusType","placeholder","disabled","ariaLabel","enteredTextLabel","onKeyDown","virtualScroll","expandToViewport","customForm","filterText","onOptionClick","hideEnteredTextOption","searchResultsId","onCloseDropdown"]),I=F===void 0?l:F,N=q.useRef(null),R=q.useRef(null),Y=Qe(R,o),U=q.useMemo(()=>Je(r||[],I),[r,I]),[j,L]=Ut({options:U,filterValue:l,filterText:I,filteringType:"manual",enteredTextLabel:v,hideEnteredTextLabel:A,onSelectItem:D=>{var he;const Fe=D.value||"";me(i,{value:Fe}),Ie(V,D)?L.resetHighlightWithKeyboard():(he=R.current)===null||he===void 0||he.close()}}),G=Yt({options:r,statusType:s,onLoadItems:D=>me(d,D)}),H=D=>{L.resetHighlightWithKeyboard(),me(i,D.detail)},Z=D=>{G.fireLoadMoreOnInputChange(D.detail.value)},ee=()=>{G.fireLoadMoreOnInputFocus(),Ie(u,null)},f=()=>{Ie(p,null)},S=D=>{Ie(_,D.detail)},te=()=>{var D;L.moveHighlightWithKeyboard(1),N.current&&((D=Pt(N.current))===null||D===void 0||D.focus())},xe=()=>{L.moveHighlightWithKeyboard(-1)},fe=()=>L.selectHighlightedOptionWithKeyboard(),re=()=>{L.resetHighlightWithKeyboard(),w==null||w()},Ee=()=>{var D;G.fireLoadMoreOnRecoveryClick(),(D=R.current)===null||D===void 0||D.focus()},Ae=X("input"),J=(t=C.controlId)!==null&&t!==void 0?t:Ae,ue=X("list"),ae=X("footer"),de=X(),ce=j.highlightedOption?de:void 0,le=!l&&!j.items.length,K=Kt(Object.assign(Object.assign({},e),{isEmpty:le,onRecoveryClick:Ee,hasRecoveryCallback:!!d}));let ge=null;return T?ge=n.createElement("div",{ref:N,className:b["custom-content-wrapper"]},T.content):j.items.length>0&&(ge=n.createElement(Jt,{statusType:s,autosuggestItemsState:j,autosuggestItemsHandlers:L,highlightedOptionId:ce,highlightText:I,listId:ue,controlId:J,handleLoadMore:G.fireLoadMoreOnScroll,hasDropdownStatus:K.content!==null,virtualScroll:k,listBottom:K.isSticky?null:n.createElement(We,{content:K.content,id:ae}),ariaDescribedby:K.content?ae:void 0})),n.createElement(Xt,Object.assign({ref:Y},C,{className:O(Zt.root,b.input),value:l,onChange:H,onFocus:ee,onBlur:f,onKeyDown:S,controlId:J,placeholder:a,disabled:c,ariaLabel:m,expandToViewport:y,ariaControls:ue,ariaActivedescendant:ce,ariaDescribedby:kt(g,C.ariaDescribedby),dropdownExpanded:j.items.length>1||K.content!==null||!!T,dropdownContentKey:T?"custom":"options",dropdownContent:ge,dropdownFooter:K.isSticky&&K.content&&!T?n.createElement(We,{content:K.content,hasItems:j.items.length>=1,id:ae}):T?T.footer:null,dropdownWidth:T?ko:_o,dropdownContentFocusable:!!T,onCloseDropdown:re,onDelayedInput:Z,onPressArrowDown:te,onPressArrowUp:xe,onPressEnter:fe,loopFocus:!!T||K.hasRecoveryButton}))}),z={root:"awsui_root_19bso_18ezr_153","inner-root":"awsui_inner-root_19bso_18ezr_154","has-groups":"awsui_has-groups_19bso_18ezr_187","compact-mode":"awsui_compact-mode_19bso_18ezr_191",token:"awsui_token_19bso_18ezr_200","inner-token":"awsui_inner-token_19bso_18ezr_201",grouped:"awsui_grouped_19bso_18ezr_214",list:"awsui_list_19bso_18ezr_226","show-operation":"awsui_show-operation_19bso_18ezr_237",select:"awsui_select_19bso_18ezr_243","inner-select":"awsui_inner-select_19bso_18ezr_244","token-content":"awsui_token-content_19bso_18ezr_248","token-content-grouped":"awsui_token-content-grouped_19bso_18ezr_254","inner-token-content":"awsui_inner-token-content_19bso_18ezr_259","edit-button":"awsui_edit-button_19bso_18ezr_264","dismiss-button":"awsui_dismiss-button_19bso_18ezr_265","inner-dismiss-button":"awsui_inner-dismiss-button_19bso_18ezr_266","token-disabled":"awsui_token-disabled_19bso_18ezr_324"},ho=q.forwardRef((e,o)=>{var{tokens:t,showOperation:l,readOnlyOperations:i,operation:u,groupOperation:p,andText:d,orText:r,groupAriaLabel:s,operationAriaLabel:a,groupEditAriaLabel:c,disabled:m=!1,onChangeOperation:v,onChangeGroupOperation:_,onDismissToken:k,editorContent:y,editorHeader:T,editorDismissAriaLabel:F,editorExpandToViewport:V,onEditorOpen:A,hasGroups:g,popoverSize:w}=e,C=_e(e,["tokens","showOperation","readOnlyOperations","operation","groupOperation","andText","orText","groupAriaLabel","operationAriaLabel","groupEditAriaLabel","disabled","onChangeOperation","onChangeGroupOperation","onDismissToken","editorContent","editorHeader","editorDismissAriaLabel","editorExpandToViewport","onEditorOpen","hasGroups","popoverSize"]);const[I,N]=q.useState(null),R=Ue({nextFocusIndex:I,onFocusMoved:j=>{j.focus(),N(null)},listItemSelector:`.${z["inner-root"]}`,fallbackSelector:`.${z.root}`}),Y=q.useRef(null),U={content:y,triggerType:"text",header:T,size:w,position:"bottom",dismissAriaLabel:F,renderWithPortal:V,__onOpen:A,__closeAnalyticsAction:"editClose"};return q.useImperativeHandle(o,()=>({closeEditor:()=>{var j;return(j=Y.current)===null||j===void 0?void 0:j.dismissPopover()}})),n.createElement(vt,Object.assign({ref:R,ariaLabel:t.length===1?t[0].ariaLabel:s,operation:l&&n.createElement(gt,{operation:u,onChange:v,ariaLabel:a,andText:d,orText:r,parent:!0,readOnlyOperations:i,disabled:m}),tokenAction:t.length===1?n.createElement(bt,{ariaLabel:t[0].dismissAriaLabel,onClick:()=>k(0),parent:!0,disabled:m}):n.createElement(st,Object.assign({ref:Y},U,{triggerType:"filtering-token"}),n.createElement(yo,{ariaLabel:c,disabled:m})),parent:!0,grouped:t.length>1,disabled:m,hasGroups:g},ft(C)),t.length===1?n.createElement(st,Object.assign({ref:Y},U),n.createElement("span",Object.assign({},ve({action:"editStart"})),t[0].content)):n.createElement("ul",{className:z.list},t.map((j,L)=>n.createElement("li",{key:L},n.createElement(vt,{ariaLabel:j.ariaLabel,operation:L!==0&&n.createElement(gt,{operation:p,onChange:_,ariaLabel:a,andText:d,orText:r,parent:!1,readOnlyOperations:i,disabled:m}),tokenAction:n.createElement(bt,{ariaLabel:j.dismissAriaLabel,onClick:()=>{k(L),N(L)},parent:!1,disabled:m}),parent:!1,grouped:!1,disabled:m,hasGroups:!1},j.content)))))}),vt=q.forwardRef((e,o)=>{var{ariaLabel:t,children:l,operation:i,tokenAction:u,parent:p,grouped:d,disabled:r,hasGroups:s}=e,a=_e(e,["ariaLabel","children","operation","tokenAction","parent","grouped","disabled","hasGroups"]);const c=q.useRef(null),m=Qe(o,c),v=Ft(c)==="compact";return n.createElement("div",Object.assign({ref:m,className:O(p?O(z.root,M["filtering-token"]):O(z["inner-root"],M["filtering-token-inner"]),s&&z["has-groups"],v&&z["compact-mode"]),role:"group","aria-label":t},ft(a)),i,n.createElement("div",{className:O(p?z.token:z["inner-token"],!!i&&z["show-operation"],d&&z.grouped,r&&z["token-disabled"]),"aria-disabled":r},n.createElement("div",{className:O(p?O(z["token-content"],M["filtering-token-content"]):O(z["inner-token-content"],M["filtering-token-inner-content"]),d&&z["token-content-grouped"])},l),u))});function gt({operation:e,onChange:o,ariaLabel:t,andText:l,orText:i,parent:u,readOnlyOperations:p,disabled:d}){return n.createElement(Ye,{__inFilteringToken:u?"root":"nested",className:O(u?O(z.select,M["filtering-token-select"]):O(z["inner-select"],M["filtering-token-inner-select"])),options:[{value:"and",label:l},{value:"or",label:i}],selectedOption:{value:e,label:e==="and"?l:i},onChange:r=>o(r.detail.selectedOption.value),disabled:d,readOnly:p,ariaLabel:t})}function bt({ariaLabel:e,onClick:o,parent:t,disabled:l}){return n.createElement("button",Object.assign({type:"button",className:O(t?O(z["dismiss-button"],M["filtering-token-dismiss-button"]):O(z["inner-dismiss-button"],M["filtering-token-inner-dismiss-button"])),"aria-label":e,onClick:o,disabled:l},ve({action:"dismiss"})),n.createElement(ht,{name:"close"}))}function yo({ariaLabel:e,disabled:o}){return n.createElement("button",{type:"button",className:O(z["edit-button"],M["filtering-token-edit-button"]),"aria-label":e,disabled:o},n.createElement(ht,{name:"edit"}))}function To({property:e,onChangePropertyKey:o,asyncProps:t,filteringProperties:l,onLoadItems:i,customGroupsText:u,i18nStrings:p,freeTextFiltering:d}){var r;const s=Le(i),a=t?Object.assign(Object.assign({},t),s):{},c=$e(l,u,p,({propertyKey:v,propertyLabel:_})=>({value:v,label:_,dontCloseOnSelect:!0})),m={label:p.allPropertiesLabel,value:void 0};return d.disabled||c.unshift(m),n.createElement(Ye,Object.assign({options:c,selectedOption:e?{value:(r=e.propertyKey)!==null&&r!==void 0?r:void 0,label:e.propertyLabel}:m,onChange:v=>o(v.detail.selectedOption.value)},a))}function Oo({property:e,operator:o,onChangeOperator:t,i18nStrings:l,freeTextFiltering:i,triggerVariant:u}){const p=(e?ke(e):i.operators).map(d=>({value:d,label:d,description:Be(d,l)}));return n.createElement(Ye,{options:p,triggerVariant:u,selectedOption:o?{value:o,label:o,description:Be(o,l)}:null,onChange:d=>t(d.detail.selectedOption.value)})}function wo(e){const{property:o,operator:t,value:l,onChangeValue:i}=e,u=(o==null?void 0:o.propertyKey)&&t&&(o==null?void 0:o.getValueFormRenderer(t));return u?n.createElement(u,{value:l,onChange:i,operator:t}):o&&t&&o.getTokenType(t)==="enum"?n.createElement(xo,Object.assign({},e,{property:o,operator:t})):n.createElement(Lo,Object.assign({},e))}function Lo({property:e,operator:o,value:t,onChangeValue:l,asyncProps:i,filteringOptions:u,onLoadItems:p,i18nStrings:d}){var r;const s=(t??"")+"",a=e?u.filter(_=>{var k;return((k=_.property)===null||k===void 0?void 0:k.propertyKey)===e.propertyKey}).map(({label:_,value:k})=>({label:_,value:k})):[],c=Le(p,"",e==null?void 0:e.externalProperty,s,o),m=e!=null&&e.propertyKey?Object.assign(Object.assign({},c),i):{empty:i.empty},[v]=a.filter(_=>_.value===s);return n.createElement(eo,Object.assign({enteredTextLabel:d.enteredTextLabel,value:(r=v==null?void 0:v.label)!==null&&r!==void 0?r:s,clearAriaLabel:d.clearAriaLabel,onChange:_=>l(_.detail.value),disabled:!o,options:a},m,{virtualScroll:!0}))}function xo({property:e,operator:o,value:t,onChangeValue:l,asyncProps:i,filteringOptions:u,onLoadItems:p}){const d=u.filter(m=>{var v;return((v=m.property)===null||v===void 0?void 0:v.propertyKey)===e.propertyKey}).map(({label:m,value:v})=>({label:m,value:v})),r=Le(p,"",e.externalProperty,void 0,o),s=Object.assign(Object.assign({statusType:"finished"},r),i),a=t?Array.isArray(t)?t:[t]:[],c=d.filter(m=>a.includes(m.value));return n.createElement("div",{className:b["token-editor-multiselect-wrapper"]},n.createElement("div",{className:b["token-editor-multiselect-wrapper-inner"]},n.createElement(Qt,Object.assign({filteringType:"auto",selectedOptions:c,onChange:m=>l(m.detail.selectedOptions.map(v=>v.value)),options:d.length>0?[{options:d,label:e.groupValuesLabel}]:[]},s,{inlineTokens:!0,hideTokens:!0,keepOpen:!0}))))}function Eo({supportsGroups:e,asyncProperties:o,asyncProps:t,customGroupsText:l,freeTextFiltering:i,filteringProperties:u,filteringOptions:p,i18nStrings:d,onLoadItems:r,onSubmit:s,onDismiss:a,tokensToCapture:c,onTokenCapture:m,onTokenRelease:v,tempGroup:_,onChangeTempGroup:k}){var y;const[T,F]=q.useState(null),V=Ue({nextFocusIndex:T,onFocusMoved:g=>{g.focus(),F(null)},listItemSelector:`.${b["token-editor-field-property"]}`,fallbackSelector:`.${b["token-editor-add-token"]}`}),A=_.map((g,w)=>{const C=L=>{var G;const H=[..._];H[w]=L,((G=L.property)===null||G===void 0?void 0:G.getTokenType(L.operator))==="enum"&&L.value===null&&(L.value=[]),k(H)},I=g.property,N=L=>{var G;const H=u.reduce((S,te)=>te.propertyKey===L?te:S,void 0),Z=H?ke(H):i.operators,ee=g.operator&&Z.indexOf(g.operator)!==-1?g.operator:Z[0],f=(G=u.find(S=>S.propertyKey===L))!==null&&G!==void 0?G:null;C(Object.assign(Object.assign({},g),{property:f,operator:ee,value:null}))},R=g.operator,Y=L=>{const G=I==null?void 0:I.getTokenType(R),H=I==null?void 0:I.getTokenType(L),ee=G!==H?null:g.value;C(Object.assign(Object.assign({},g),{operator:L,value:ee}))},U=g.value;return{token:g,property:I,onChangePropertyKey:N,operator:R,onChangeOperator:Y,value:U,onChangeValue:L=>{C(Object.assign(Object.assign({},g),{value:L}))}}});return n.createElement("div",{className:b["token-editor"],ref:V},n.createElement(Ao,{supportsGroups:e,tokens:A.map(g=>g.token),onRemove:g=>{const w=_.filter((C,I)=>I!==g);k(w),F(g)},onRemoveFromGroup:g=>{const w=_[g],C=_.filter((I,N)=>N!==g);k(C),v(w),F(g)},onSubmit:s,renderProperty:g=>n.createElement(To,{property:A[g].property,onChangePropertyKey:A[g].onChangePropertyKey,asyncProps:o?t:null,filteringProperties:u,onLoadItems:r,customGroupsText:l,i18nStrings:d,freeTextFiltering:i}),renderOperator:g=>n.createElement(Oo,{property:A[g].property,operator:A[g].operator,onChangeOperator:A[g].onChangeOperator,i18nStrings:d,freeTextFiltering:i,triggerVariant:e?"label":"option"}),renderValue:g=>n.createElement(wo,{property:A[g].property,operator:A[g].operator,value:A[g].value,onChangeValue:A[g].onChangeValue,asyncProps:t,filteringOptions:p,onLoadItems:r,i18nStrings:d}),i18nStrings:d}),e&&n.createElement("div",{className:O(b["token-editor-add-token"],M["token-editor-token-add-actions"])},n.createElement(He,{variant:"normal",ariaLabel:d.tokenEditorAddTokenActionsAriaLabel,items:c.map((g,w)=>{var C,I,N,R;return{id:w.toString(),text:(I=(C=d.tokenEditorAddExistingTokenLabel)===null||C===void 0?void 0:C.call(d,g))!==null&&I!==void 0?I:"",ariaLabel:(R=(N=d.tokenEditorAddExistingTokenAriaLabel)===null||N===void 0?void 0:N.call(d,g))!==null&&R!==void 0?R:""}}),onItemClick:({detail:g})=>{const w=parseInt(g.id);!isNaN(w)&&c[w]&&(k([..._,Object.assign({},c[w])]),F(A.length),m(c[w]))},disabled:c.length===0,showMainActionOnly:c.length===0,mainAction:{text:(y=d.tokenEditorAddNewTokenLabel)!==null&&y!==void 0?y:"",onClick:()=>{var g;const w=_[_.length-1],C=w?w.property:null,I=(g=C==null?void 0:C.defaultOperator)!==null&&g!==void 0?g:":";k([..._,{property:C,operator:I,value:null}]),F(A.length)}}})),n.createElement("div",{className:b["token-editor-actions"]},n.createElement("span",Object.assign({},ve({action:"editCancel"})),n.createElement(Oe,{formAction:"none",variant:"link",className:O(b["token-editor-cancel"],M["token-editor-cancel"]),onClick:a},d.cancelActionText)),n.createElement("span",Object.assign({},ve({action:"editConfirm"})),n.createElement(Oe,{className:O(b["token-editor-submit"],M["token-editor-submit"]),formAction:"none",onClick:s},d.applyActionText))))}function Ao({tokens:e,supportsGroups:o,onRemove:t,onRemoveFromGroup:l,onSubmit:i,renderProperty:u,renderOperator:p,renderValue:d,i18nStrings:r}){const a=St()||!o,c=X(),m=X(),v=X(),_=n.createElement("div",{className:b["token-editor-grid-group"]},n.createElement("div",{id:c,className:b["token-editor-grid-header"]},r.propertyText),n.createElement("div",{id:m,className:b["token-editor-grid-header"]},r.operatorText),n.createElement("div",{id:v,className:b["token-editor-grid-header"]},r.valueText),n.createElement("div",{className:b["token-editor-grid-header"]}));return n.createElement("form",{className:O(b["token-editor-grid"],a&&b["token-editor-narrow"],b["token-editor-form"]),onSubmit:k=>{k.preventDefault(),i()}},!a&&_,e.map((k,y)=>{var T,F,V,A,g,w;return n.createElement("div",{key:y,role:"group","aria-label":r.formatToken(k).formattedText,className:O(b["token-editor-grid-group"],o&&b["token-editor-supports-groups"])},n.createElement("div",{className:O(b["token-editor-grid-cell"],a&&b["token-editor-narrow"])},n.createElement(Ke,{isNarrow:a,label:r.propertyText,labelId:c,className:O(b["token-editor-field-property"],M["token-editor-field-property"]),index:y},u(y))),n.createElement("div",{className:O(b["token-editor-grid-cell"],a&&b["token-editor-narrow"])},n.createElement(Ke,{isNarrow:a,label:r.operatorText,labelId:m,className:O(b["token-editor-field-operator"],M["token-editor-field-operator"]),index:y},p(y))),n.createElement("div",{className:O(b["token-editor-grid-cell"],a&&b["token-editor-narrow"])},n.createElement(Ke,{isNarrow:a,label:r.valueText,labelId:v,className:O(b["token-editor-field-value"],M["token-editor-field-value"]),index:y},d(y))),o&&n.createElement("div",{className:O(b["token-editor-grid-cell"],a&&b["token-editor-narrow"])},n.createElement("div",{className:b["token-editor-remove-token"]},n.createElement(Co,{isNarrow:a,ariaLabel:(F=(T=r.tokenEditorTokenActionsAriaLabel)===null||T===void 0?void 0:T.call(r,k))!==null&&F!==void 0?F:"",mainActionAriaLabel:(A=(V=r.tokenEditorTokenRemoveAriaLabel)===null||V===void 0?void 0:V.call(r,k))!==null&&A!==void 0?A:"",disabled:e.length===1,items:[{id:"remove",text:(g=r.tokenEditorTokenRemoveLabel)!==null&&g!==void 0?g:"",disabled:k.standaloneIndex!==void 0},{id:"remove-from-group",text:(w=r.tokenEditorTokenRemoveFromGroupLabel)!==null&&w!==void 0?w:""}],onItemClick:C=>{switch(C){case"remove":return t(y);case"remove-from-group":return l(y)}},index:y}))))}))}function Ke({isNarrow:e,label:o,labelId:t,children:l,className:i,index:u}){return e?n.createElement(ut,{label:o,className:i,stretch:!0,"data-testindex":u},l):n.createElement(_t.Provider,{value:{ariaLabelledby:t}},n.createElement(ut,{className:i,"data-testindex":u},l))}function Co({isNarrow:e,ariaLabel:o,mainActionAriaLabel:t,disabled:l,items:i,onItemClick:u,index:p}){return e?n.createElement(He,{variant:"normal",ariaLabel:o,items:i.slice(1),onItemClick:({detail:d})=>u(d.id),disabled:l,mainAction:{text:i[0].text,onClick:()=>u(i[0].id),disabled:l,ariaLabel:t},className:M["token-editor-token-remove-actions"],"data-testindex":p}):n.createElement(He,{variant:"icon",ariaLabel:o,items:i,onItemClick:({detail:d})=>u(d.id),disabled:l,className:M["token-editor-token-remove-actions"],"data-testindex":p})}const Pe={"token-trigger":"awsui_token-trigger_1b6uy_xiape_5","search-field":"awsui_search-field_1b6uy_xiape_6"},Io=({query:e,onUpdateToken:o,onUpdateOperation:t,onRemoveToken:l,tokenIndex:i,filteringProperties:u,filteringOptions:p,asyncProps:d,onLoadItems:r,i18nStrings:s,asyncProperties:a,hideOperations:c,readOnlyOperations:m,customGroupsText:v,disabled:_,freeTextFiltering:k,expandToViewport:y,enableTokenGroups:T})=>{var F,V,A,g;const w=q.useRef(null),C=e.tokens.some(f=>"operation"in f),I=i===0,N=e.tokens[i],R=we([N]).map(f=>Object.assign(Object.assign({},f),{standaloneIndex:void 0})),Y=e.operation,U="operation"in N?N.operation:Y==="and"?"or":"and",[j,L]=q.useState(R),G=j.map(f=>f.standaloneIndex).filter(f=>f!==void 0),H=[];for(let f=0;f<e.tokens.length;f++){const S=e.tokens[f];"operator"in S&&S!==N&&!G.includes(f)&&H.push(S)}const[Z,ee]=q.useState([]);return H.push(...Z),n.createElement(ho,Object.assign({ref:w,tokens:R.map(f=>{const S=s.formatToken(f);return{content:n.createElement("span",{className:O(b["token-trigger"],Pe["token-trigger"])},n.createElement(jo,{token:S,allProperties:f.property===null})),ariaLabel:S.formattedText,dismissAriaLabel:s.removeTokenButtonAriaLabel(f)}}),showOperation:!I&&!c,readOnlyOperations:!!m,operation:Y,andText:(F=s.operationAndText)!==null&&F!==void 0?F:"",orText:(V=s.operationOrText)!==null&&V!==void 0?V:"",operationAriaLabel:(A=s.tokenOperatorAriaLabel)!==null&&A!==void 0?A:"",onChangeOperation:t,onDismissToken:f=>{if(R.length===1)l();else{const S=R.filter((xe,fe)=>fe!==f),te=S.length===1?S[0]:{operation:U,tokens:S};o(te,[])}},disabled:_,editorContent:n.createElement(Eo,{supportsGroups:T,filteringProperties:u,filteringOptions:p,tempGroup:j,onChangeTempGroup:L,tokensToCapture:H,onTokenCapture:f=>ee(S=>S.filter(te=>te!==f)),onTokenRelease:f=>{f.standaloneIndex===void 0&&ee(S=>[...S,f])},asyncProps:d,onLoadItems:r,i18nStrings:s,asyncProperties:a,customGroupsText:v,freeTextFiltering:k,onDismiss:()=>{var f;(f=w.current)===null||f===void 0||f.closeEditor()},onSubmit:()=>{var f;const S=j.length===1?j[0]:{operation:U,tokens:j};o(S,Z),(f=w.current)===null||f===void 0||f.closeEditor()}}),editorHeader:(g=s.editTokenHeader)!==null&&g!==void 0?g:"",editorDismissAriaLabel:s.dismissAriaLabel,editorExpandToViewport:!!y,onEditorOpen:()=>{L(R),ee([])},groupOperation:U,onChangeGroupOperation:f=>o({operation:f,tokens:R},[]),groupAriaLabel:s.groupAriaLabel({operation:U,tokens:R}),groupEditAriaLabel:s.groupEditAriaLabel({operation:U,tokens:R}),hasGroups:C,popoverSize:T?"content":"large"},ve({detail:{tokenPosition:`${i+1}`,tokenLabel:`.${Pe["token-trigger"]}`}})))},jo=({token:{propertyLabel:e,operator:o,value:t},allProperties:l})=>{e&&(e+=" ");const u=o===":"&&l?"":o+" ";return n.createElement(n.Fragment,null,l?"":e,n.createElement("span",{className:b["token-operator"]},u),t)},Po=n.forwardRef((e,o)=>{var t,{disabled:l,countText:i,query:u,hideOperations:p,readOnlyOperations:d,onChange:r,filteringProperties:s,filteringOptions:a,customGroupsText:c,disableFreeTextFiltering:m,freeTextFiltering:v,onLoadItems:_,virtualScroll:k,customControl:y,customFilterActions:T,filteringPlaceholder:F,filteringAriaLabel:V,filteringEmpty:A,filteringLoadingText:g,filteringFinishedText:w,filteringErrorText:C,filteringRecoveryText:I,filteringConstraintText:N,filteringStatusType:R,asyncProperties:Y,tokenLimit:U,expandToViewport:j,tokenLimitShowFewerAriaLabel:L,tokenLimitShowMoreAriaLabel:G,enableTokenGroups:H,loading:Z=!1,__internalRootRef:ee}=e,f=_e(e,["disabled","countText","query","hideOperations","readOnlyOperations","onChange","filteringProperties","filteringOptions","customGroupsText","disableFreeTextFiltering","freeTextFiltering","onLoadItems","virtualScroll","customControl","customFilterActions","filteringPlaceholder","filteringAriaLabel","filteringEmpty","filteringLoadingText","filteringFinishedText","filteringErrorText","filteringRecoveryText","filteringConstraintText","filteringStatusType","asyncProperties","tokenLimit","expandToViewport","tokenLimitShowFewerAriaLabel","tokenLimitShowMoreAriaLabel","enableTokenGroups","loading","__internalRootRef"]);const[S,te]=q.useState(null),xe=Ue({nextFocusIndex:S,onFocusMoved:(h,x)=>{var P;x==="fallback"?(P=re.current)===null||P===void 0||P.focus({preventDropdown:!0}):h.focus(),te(null)},listItemSelector:`.${lt["list-item"]}`,showMoreSelector:`.${lt.toggle}`,fallbackSelector:`.${b.input}`}),fe=Qe(xe,ee),re=q.useRef(null),Ee=q.useRef(null),Ae=Nt(f),J=ao(f.i18nStrings);q.useImperativeHandle(o,()=>({focus:()=>{var h;return(h=re.current)===null||h===void 0?void 0:h.focus()}}),[]);const[ue,ae]=q.useState(""),{internalProperties:de,internalOptions:ce,internalQuery:le,internalFreeText:K}=(()=>{var h,x;const P=s.reduce((B,E)=>{var ie,De,ze,qe,Ve;const Me=((ie=E==null?void 0:E.operators)!==null&&ie!==void 0?ie:[]).reduce(($,Q)=>typeof Q=="object"?$.set(Q.operator,Q):$,new Map);return B.set(E.key,{propertyKey:E.key,propertyLabel:(De=E==null?void 0:E.propertyLabel)!==null&&De!==void 0?De:"",groupValuesLabel:(ze=E==null?void 0:E.groupValuesLabel)!==null&&ze!==void 0?ze:"",propertyGroup:E==null?void 0:E.group,operators:((qe=E==null?void 0:E.operators)!==null&&qe!==void 0?qe:[]).map($=>typeof $=="string"?$:$.operator),defaultOperator:(Ve=E==null?void 0:E.defaultOperator)!==null&&Ve!==void 0?Ve:"=",getTokenType:$=>{var Q,oe;return $&&(oe=(Q=Me.get($))===null||Q===void 0?void 0:Q.tokenType)!==null&&oe!==void 0?oe:"value"},getValueFormatter:$=>{var Q,oe;return $&&(oe=(Q=Me.get($))===null||Q===void 0?void 0:Q.format)!==null&&oe!==void 0?oe:null},getValueFormRenderer:$=>{var Q,oe;return $&&(oe=(Q=Me.get($))===null||Q===void 0?void 0:Q.form)!==null&&oe!==void 0?oe:null},externalProperty:E}),B},new Map),ne=B=>{var E;return(E=P.get(B))!==null&&E!==void 0?E:null},se=a.map(B=>{var E,ie;return{property:ne(B.propertyKey),value:B.value,label:(ie=(E=B.label)!==null&&E!==void 0?E:B.value)!==null&&ie!==void 0?ie:""}});function pe(B,E){return"operation"in B?{operation:B.operation,tokens:B.tokens.map(ie=>pe(ie))}:{standaloneIndex:E,property:B.propertyKey?ne(B.propertyKey):null,operator:B.operator,value:B.value}}const Te={operation:u.operation,tokens:(H&&u.tokenGroups?u.tokenGroups:u.tokens).map(pe)},Et={disabled:m,operators:(h=v==null?void 0:v.operators)!==null&&h!==void 0?h:[":","!:"],defaultOperator:(x=v==null?void 0:v.defaultOperator)!==null&&x!==void 0?x:":"};return{internalProperties:[...P.values()],internalOptions:se,internalQuery:Te,internalFreeText:Et}})(),{addToken:ge,updateToken:D,updateOperation:he,removeToken:Fe,removeAllTokens:Xe}=lo({query:le,filteringOptions:ce,onChange:r,enableTokenGroups:H}),ye=Ge(ue,de,K),yt=uo(ye,de,ce,c,J),Tt=h=>{const x=Ge(h,de,K);let P;switch(x.step){case"property":{P={property:x.property,operator:x.operator,value:x.value};break}case"free-text":{P={property:null,operator:x.operator||K.defaultOperator,value:x.value};break}case"operator":{P={property:null,operator:K.defaultOperator,value:h};break}}K.disabled&&!P.property||(ge(P),ae(""))},Ze=(h,x)=>{const P={filteringProperty:void 0,filteringText:x,filteringOperator:void 0};return h.step==="property"&&(P.filteringProperty=h.property.externalProperty,P.filteringText=h.value,P.filteringOperator=h.operator),P},Ce=Ze(ye,ue),et=Le(_,Ce.filteringText,Ce.filteringProperty,Ce.filteringText,Ce.filteringOperator),Se={empty:A,loadingText:g,finishedText:w,errorText:C,recoveryText:I,statusType:R},Ot=ue.length||Y?Object.assign(Object.assign({},et),Se):{},wt=h=>{var x;const{detail:P}=h,ne=P.value||"";if(!ne)return;if(!("keepOpenOnSelect"in P)){Tt(ne);return}h.preventDefault();const se=Ge(ne,de,K),pe=Ze(se,ne);if(se.step==="operator"){const Te=ke(se.property);ne.trim()===se.property.propertyLabel&&Te.length===1&&(pe.filteringProperty=(x=se.property.externalProperty)!==null&&x!==void 0?x:void 0,pe.filteringOperator=Te[0],pe.filteringText="",ae(se.property.propertyLabel+" "+Te[0]+" "))}me(_,Object.assign(Object.assign({},pe),{firstPage:!0,samePage:!1}))};Rt({searchQuery:u,countText:i,loading:Z,announceCallback:()=>{var h;(h=Ee.current)===null||h===void 0||h.reannounce()}});const W=ye.step==="property"?ye:null,be=W?W.property.propertyKey+":"+W.operator:"",[tt,ot]=q.useState({}),Ne=be in tt?tt[be]:null,rt=h=>ot({[be]:h}),Re=W&&W.property.getValueFormRenderer(W.operator),Lt=(W==null?void 0:W.property.getTokenType(W.operator))==="enum",nt=X("property-filter-search-results"),at=X("property-filter-constraint"),xt=N?kt(f.ariaDescribedby,at):f.ariaDescribedby,it=!!(!((t=le.tokens)===null||t===void 0)&&t.length)&&!l&&!!i;return n.createElement("div",Object.assign({},Ae,{className:O(Ae.className,b.root),ref:fe}),n.createElement("div",{className:O(b["search-field"],Pe["search-field"])},y&&n.createElement("div",{className:b["custom-control"]},y),n.createElement("div",{className:b["input-wrapper"]},n.createElement(fo,Object.assign({ref:re,virtualScroll:k,enteredTextLabel:J.enteredTextLabel,ariaLabel:V??J.filteringAriaLabel,placeholder:F??J.filteringPlaceholder,ariaLabelledby:f.ariaLabelledby,ariaDescribedby:xt,controlId:f.controlId,value:ue,disabled:l},yt,{onChange:h=>ae(h.detail.value),empty:A},Ot,{expandToViewport:j,onOptionClick:wt,customForm:Re||Lt?{content:Re?n.createElement(vo,{key:be,property:W.property,operator:W.operator,filter:W.value,operatorForm:Re,value:Ne,onChange:rt}):n.createElement(go,{key:be,property:W.property,filter:W.value,value:Ne,onChange:rt,asyncProps:Se,filteringOptions:ce,onLoadItems:et.onLoadItems}),footer:n.createElement(bo,{key:be,property:W.property,operator:W.operator,value:Ne,i18nStrings:J,onCancel:()=>{var h,x;ae(""),(h=re.current)===null||h===void 0||h.close(),(x=re.current)===null||x===void 0||x.focus({preventDropdown:!0})},onSubmit:h=>{var x,P;ge(h),ae(""),(x=re.current)===null||x===void 0||x.focus({preventDropdown:!0}),(P=re.current)===null||P===void 0||P.close()}})}:void 0,onCloseDropdown:()=>ot({}),hideEnteredTextOption:K.disabled&&ye.step!=="property",clearAriaLabel:J.clearAriaLabel,searchResultsId:it?nt:void 0})),it?n.createElement("div",{className:b.results},n.createElement(Dt,{id:nt,renderLiveRegion:!Z,ref:Ee},i)):null)),N&&n.createElement("div",{id:at,className:b.constraint},N),le.tokens&&le.tokens.length>0&&n.createElement("div",{className:b.tokens},n.createElement(zt,{size:"xs",direction:"horizontal"},n.createElement(Gt,{alignment:"inline",limit:U,items:le.tokens,limitShowFewerAriaLabel:L,limitShowMoreAriaLabel:G,renderItem:(h,x)=>n.createElement(Io,{query:le,tokenIndex:x,onUpdateToken:(P,ne)=>{D(x,P,ne)},onUpdateOperation:he,onRemoveToken:()=>{Fe(x),te(x)},filteringProperties:de,filteringOptions:ce,asyncProps:Se,onLoadItems:_,i18nStrings:J,asyncProperties:Y,hideOperations:p,readOnlyOperations:d,customGroupsText:c,freeTextFiltering:K,disabled:l,expandToViewport:j,enableTokenGroups:H}),i18nStrings:{limitShowFewer:J.tokenLimitShowFewer,limitShowMore:J.tokenLimitShowMore},after:T?n.createElement("div",{className:b["custom-filter-actions"]},T):n.createElement("span",Object.assign({},ve({action:"clearFilters"})),n.createElement(Oe,{formAction:"none",onClick:()=>{var h;Xe(),(h=re.current)===null||h===void 0||h.focus({preventDropdown:!0})},className:b["remove-all"],disabled:l},J.clearFiltersText))}))))}),Fo=n.forwardRef((e,o)=>{var t,{filteringProperties:l,filteringOptions:i=[],customGroupsText:u=[],enableTokenGroups:p=!1,disableFreeTextFiltering:d=!1,asyncProperties:r,expandToViewport:s,hideOperations:a=!1,readOnlyOperations:c=!1,tokenLimit:m,virtualScroll:v}=e,_=_e(e,["filteringProperties","filteringOptions","customGroupsText","enableTokenGroups","disableFreeTextFiltering","asyncProperties","expandToViewport","hideOperations","readOnlyOperations","tokenLimit","virtualScroll"]);let k=!1,y=!1,T=!1;for(const A of l)for(const g of(t=A.operators)!==null&&t!==void 0?t:[])typeof g=="object"&&(k=k||!!g.form,y=y||g.tokenType==="enum",T=T||!!g.format);const F=qt("PropertyFilter",{props:{asyncProperties:r,disableFreeTextFiltering:d,enableTokenGroups:p,expandToViewport:s,hideOperations:a,readOnlyOperations:c,tokenLimit:m,virtualScroll:v},metadata:{hasCustomForms:k,hasEnumTokens:y,hasCustomFormatters:T}}),V={name:"awsui.PropertyFilter",label:`.${Pe["search-field"]} input`,properties:{disabled:`${!!_.disabled}`,queryTokensCount:`${_.query&&_.query.tokens?_.query.tokens.length:0}`}};return a&&p&&(Vt("PropertyFilter","Operations cannot be hidden when token groups are enabled."),a=!1),n.createElement(Po,Object.assign({ref:o},F,{filteringProperties:l,filteringOptions:i,customGroupsText:u,enableTokenGroups:p,disableFreeTextFiltering:d,asyncProperties:r,expandToViewport:s,hideOperations:a,readOnlyOperations:c,tokenLimit:m,virtualScroll:v},ve({component:V}),_))});Mt(Fo,"PropertyFilter");export{Fo as P};
