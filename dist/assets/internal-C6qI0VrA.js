import{R as f,_ as ee,n as fe,m as Ie,r as m,p as xe,aC as Be,a9 as je,O as _,bC as he,br as ge,P as Y,M as Pe,w as Te,bn as ke,bD as Fe,au as He,o as Z}from"./index-BE4yRgP3.js";import{g as We,b as Se,d as Ue,O as Ne,S as qe,e as Ge,a as Ve,c as ze,u as $e,D as Oe}from"./index-CWZQ9OB-.js";import{c as Qe}from"./index-DFd9ICZj.js";const pe={"dropdown-footer":"awsui_dropdown-footer_vm8qf_jxdvh_5","dropdown-content":"awsui_dropdown-content_vm8qf_jxdvh_10"},Je=f.forwardRef((e,o)=>{var{value:a,onChange:s,onBlur:t,onFocus:h,onKeyUp:i,onKeyDown:c,name:u,placeholder:n,disabled:l,readOnly:p,autoFocus:g,ariaLabel:b,ariaRequired:y,disableBrowserAutocorrect:O=!1,expandToViewport:w,ariaControls:A,ariaActivedescendant:x,clearAriaLabel:P,dropdownExpanded:v=!0,dropdownContentKey:E,dropdownContentFocusable:k=!1,dropdownContent:B=null,dropdownFooter:H=null,dropdownWidth:V,loopFocus:te,onCloseDropdown:oe,onDelayedInput:ne,onPressArrowDown:W,onPressArrowUp:I,onPressEnter:T,__internalRootRef:S}=e,z=ee(e,["value","onChange","onBlur","onFocus","onKeyUp","onKeyDown","name","placeholder","disabled","readOnly","autoFocus","ariaLabel","ariaRequired","disableBrowserAutocorrect","expandToViewport","ariaControls","ariaActivedescendant","clearAriaLabel","dropdownExpanded","dropdownContentKey","dropdownContentFocusable","dropdownContent","dropdownFooter","dropdownWidth","loopFocus","onCloseDropdown","onDelayedInput","onPressArrowDown","onPressArrowUp","onPressEnter","__internalRootRef"]);const $=fe(z),re=Ie(z),C=m.useRef(null),L=m.useRef(null),M=m.useRef(null),U=m.useRef(!1),N=m.useRef(!1),[R,Q]=m.useState(!1),K=()=>!p&&Q(!0),j=()=>{Q(!1),_(oe,null)};m.useImperativeHandle(o,()=>({focus(r){var F;r!=null&&r.preventDropdown&&(U.current=!0),(F=C.current)===null||F===void 0||F.focus()},select(){var r;(r=C.current)===null||r===void 0||r.select()},open:K,close:j}));const se=()=>{N.current||(j(),_(t,null))},ie=()=>{U.current||(K(),_(h,null)),U.current=!1},q=r=>ge(c,r.detail,r),ae=r=>{switch(r.detail.keyCode){case Y.down:{W==null||W(),K(),r.preventDefault();break}case Y.up:{I==null||I(),K(),r.preventDefault();break}case Y.enter:{R&&(T!=null&&T()||j(),r.preventDefault()),q(r);break}case Y.escape:{R?(r.stopPropagation(),j()):a&&(r.stopPropagation(),_(s,{value:""})),r.preventDefault(),q(r);break}default:q(r)}},le=r=>{K(),_(s,{value:r})},de=r=>{_(ne,{value:r})},ce=r=>{k?(N.current=!0,requestAnimationFrame(()=>{N.current=!1})):r.preventDefault()},X={name:u,placeholder:n,autoFocus:g,onClick:K,role:"combobox","aria-autocomplete":"list","aria-expanded":R&&v,"aria-controls":R?A:void 0,"aria-owns":R?A:void 0,"aria-label":b,"aria-activedescendant":x};return m.useEffect(()=>{if(!R)return;const r=F=>{!he(C.current,F.target)&&!he(L.current,F.target)&&!he(M.current,F.target)&&j()};return window.addEventListener("mousedown",r),()=>{window.removeEventListener("mousedown",r)}},[R]),f.createElement("div",Object.assign({},$,{className:xe($.className,pe.root),ref:S}),f.createElement(Be,{minWidth:V,stretchWidth:!V,stretchBeyondTriggerWidth:!0,contentKey:E,onFocus:ie,onBlur:se,trigger:f.createElement(je,Object.assign({type:"visualSearch",value:a,onChange:r=>le(r.detail.value),__onDelayedInput:r=>de(r.detail.value),onKeyDown:ae,onKeyUp:i,disabled:l,disableBrowserAutocorrect:O,readOnly:p,ariaRequired:y,clearAriaLabel:P,ref:C,autoComplete:!1,__nativeAttributes:X},re)),onMouseDown:ce,open:R&&(!!B||!!H),footer:M&&f.createElement("div",{ref:M,className:pe["dropdown-footer"]},R&&H?H:null),expandToViewport:w,loopFocus:te},R&&B?f.createElement("div",{ref:L,className:pe["dropdown-content"]},B):null))}),Xe=({options:e=[],statusType:o,onLoadItems:a})=>{const s=m.useRef(null),t=({firstPage:n,samePage:l,filteringText:p})=>{var g;(p===void 0||s.current!==p)&&(p!==void 0&&(s.current=p),a({filteringText:(g=s.current)!==null&&g!==void 0?g:"",firstPage:n,samePage:l}))};return{fireLoadMoreOnScroll:()=>{e.length>0&&o==="pending"&&t({firstPage:!1,samePage:!1})},fireLoadMoreOnRecoveryClick:()=>t({firstPage:!1,samePage:!0}),fireLoadMoreOnInputFocus:()=>{var n;return t({firstPage:!0,samePage:!1,filteringText:(n=s.current)!==null&&n!==void 0?n:""})},fireLoadMoreOnInputChange:n=>t({firstPage:!0,samePage:!1,filteringText:n})}},De=e=>"type"in e&&e.type==="parent",Ce=e=>{if(e.length){const o=e[e.length-1];De(o)&&e.pop()}},Ye=(e,o)=>{const a=e.reduce((s,t)=>(De(t)?(Ce(s),s.push(t)):Ze(t,o)&&s.push(t),s),[]);return Ce(a),a},Ze=(e,o)=>{const a=["value","label","description","labelTag"],s=["tags","filteringTags"],t=o.toLowerCase(),h=c=>Le(e[c],t),i=c=>{var u;return(u=e[c])===null||u===void 0?void 0:u.some(n=>Le(n,t))};return a.some(h)||s.some(i)},Le=(e,o)=>e&&e.toLowerCase().indexOf(o)!==-1,Ae=e=>!!e&&e.type!=="parent",Re=e=>!!e&&!e.disabled&&e.type!=="parent",et=({options:e,filterValue:o,filterText:a,filteringType:s,enteredTextLabel:t,hideEnteredTextLabel:h,onSelectItem:i})=>{const c=Pe("autosuggest"),[u,n]=m.useState(!1),{items:l,getItemGroup:p,getItemParent:g}=m.useMemo(()=>tt(e),[e]),b=c("enteredTextLabel",t==null?void 0:t(o),v=>v({value:o}));b||Te("Autosuggest","A value for enteredTextLabel must be provided.");const y=m.useMemo(()=>{const v=s==="auto"&&!u?Ye(l,a):[...l];return o&&!h&&v.unshift({value:o,type:"use-entered",label:b,option:{value:o}}),We(v,g),v},[s,u,l,a,o,h,g,b]),[O,w]=Se({options:y,isHighlightable:Ae}),A=()=>{var v;return O.highlightedOption&&!Re(O.highlightedOption)?!1:(i((v=O.highlightedOption)!==null&&v!==void 0?v:{value:o,type:"use-entered",option:{value:o}}),!0)},x=v=>{y[v]&&Ae(y[v])&&w.setHighlightedIndexWithMouse(v)},P=v=>{y[v]&&Re(y[v])&&i(y[v])};return[Object.assign(Object.assign({},O),{items:y,showAll:u,getItemGroup:p}),Object.assign(Object.assign({},w),{setShowAll:n,selectHighlightedOptionWithKeyboard:A,highlightVisibleOptionWithMouse:x,selectVisibleOptionWithMouse:P})]};function tt(e){const o=[],a=new WeakMap,s=i=>a.get(i),t=i=>{var c;return(c=s(i))===null||c===void 0?void 0:c.option};for(const i of e)if(ot(i))for(const c of h(i))o.push(c);else o.push(Object.assign(Object.assign({},i),{option:i}));function h(i){const{options:c}=i,u=ee(i,["options"]);let n=!0;const l=Object.assign(Object.assign({},u),{type:"parent",option:i}),p=[l];for(const g of c){g.disabled||(n=!1);const b=Object.assign(Object.assign({},g),{type:"child",disabled:g.disabled||u.disabled,option:g});p.push(b),a.set(b,l)}return p[0].disabled=p[0].disabled||n,p}return{items:o,getItemGroup:t,getItemParent:s}}function ot(e){return"options"in e}const G={root:"awsui_root_12hwc_oboi4_5","layout-strut":"awsui_layout-strut_12hwc_oboi4_9","list-bottom":"awsui_list-bottom_12hwc_oboi4_15"},nt=(e,o)=>{var{nativeAttributes:a={},highlightText:s,option:t,highlighted:h,highlightType:i,current:c,virtualPosition:u,padBottom:n,screenReaderContent:l,ariaSetsize:p,ariaPosinset:g}=e,b=ee(e,["nativeAttributes","highlightText","option","highlighted","highlightType","current","virtualPosition","padBottom","screenReaderContent","ariaSetsize","ariaPosinset"]);const y=fe(b),O="type"in t&&t.type==="use-entered",w="type"in t&&t.type==="parent",A="type"in t&&t.type==="child",{throughIndex:x,inGroupIndex:P,groupIndex:v}=Ue(t)||{};let E;if(O)E=t.label,l=void 0;else if(w)E=t.label;else{const k={};a["aria-label"]&&(k["aria-label"]=a["aria-label"]),E=f.createElement("div",Object.assign({},k),f.createElement(Ne,{option:t,highlightedOption:h,highlightText:s}))}return f.createElement(qe,Object.assign({},y,{className:G.option,ariaSelected:c,highlighted:h,disabled:t.disabled,hasBackground:O,isParent:w,isChild:A,virtualPosition:u,"data-test-index":x,"data-in-group-index":P,"data-group-index":v,ref:o,padBottom:n,screenReaderContent:l,ariaSetsize:p,ariaPosinset:g,highlightType:i.type,value:t.value}),E)},Ee=f.memo(f.forwardRef(nt)),Me=(e,o,a,s,t,h)=>{const i=o===t?s:{},c=fe(i),u=e===a.length-1,n=a.length>1;return Object.assign({nativeAttributes:i,padBottom:!h&&n&&u},c)},rt=({autosuggestItemsState:e,handleLoadMore:o,menuProps:a,highlightedA11yProps:s,hasDropdownStatus:t,highlightText:h,listBottom:i,screenReaderContent:c})=>{const u=m.useRef(null);return m.useEffect(()=>{var n;const l=(n=u.current)===null||n===void 0?void 0:n.querySelector(`[data-mouse-target="${e.highlightedIndex}"]`);e.highlightType.moveFocus&&l&&ke(l)},[e.highlightType,e.highlightedIndex]),f.createElement(Fe,Object.assign({},a,{onLoadMore:o,open:!0,ref:u}),e.items.map((n,l)=>{const p=Me(l,n,e.items,s,e.highlightedOption,t);return f.createElement(Ee,Object.assign({highlightText:h,option:n,highlighted:n===e.highlightedOption,current:n.value===h,key:l,"data-mouse-target":l,screenReaderContent:c,highlightType:e.highlightType},p))}),i?f.createElement("li",{role:"option",className:G["list-bottom"]},i):null)},st=({autosuggestItemsState:e,handleLoadMore:o,menuProps:a,highlightedA11yProps:s,hasDropdownStatus:t,highlightText:h,listBottom:i,screenReaderContent:c})=>{const u=m.useRef(null),[n,l]=He(g=>g.contentBoxWidth,[]);m.useImperativeHandle(l,()=>u.current);const p=Ge({items:e.items,parentRef:u,estimateSize:m.useCallback(()=>31,[n,h])});return m.useEffect(()=>{e.highlightType.moveFocus&&p.scrollToIndex(e.highlightedIndex)},[e.highlightType,e.highlightedIndex,p]),f.createElement(Fe,Object.assign({},a,{onLoadMore:o,ref:u,open:!0}),f.createElement("div",{"aria-hidden":"true",key:"total-size",className:G["layout-strut"],style:{height:p.totalSize+(e.items.length===1?1:0)}}),p.virtualItems.map(g=>{const{index:b,start:y,measureRef:O}=g,w=e.items[b],A=Me(b,w,e.items,s,e.highlightedOption,t);return f.createElement(Ee,Object.assign({key:b,ref:O,highlightText:h,option:w,highlighted:w===e.highlightedOption,current:w.value===h,"data-mouse-target":b,virtualPosition:y+(b===0?1:0),screenReaderContent:c,ariaSetsize:e.items.length,ariaPosinset:b+1,highlightType:e.highlightType},A))}),i?f.createElement("li",{role:"option",className:G["list-bottom"]},i):null)},_e=e=>o=>{o>-1&&e(o)};function it({statusType:e,autosuggestItemsState:o,autosuggestItemsHandlers:a,highlightedOptionId:s,highlightText:t,listId:h,controlId:i,handleLoadMore:c,hasDropdownStatus:u,virtualScroll:n,selectedAriaLabel:l,renderHighlightedAriaLive:p,listBottom:g,ariaDescribedby:b}){var y;const O=_e(a.selectVisibleOptionWithMouse),w=_e(a.highlightVisibleOptionWithMouse),A=n?st:rt,x=Ve({highlightText:t,announceSelected:((y=o.highlightedOption)===null||y===void 0?void 0:y.value)===t,highlightedOption:o.highlightedOption,getParent:P=>o.getItemGroup(P),selectedAriaLabel:l,renderHighlightedAriaLive:p});return f.createElement(A,{listBottom:g,handleLoadMore:c,autosuggestItemsState:o,highlightText:t,highlightedA11yProps:s?{id:s}:{},hasDropdownStatus:u,menuProps:{id:h,ariaLabelledby:i,onMouseUp:O,onMouseMove:w,ariaDescribedby:b,statusType:e},screenReaderContent:x})}const ct=f.forwardRef((e,o)=>{var a,s;const{value:t,onChange:h,onBlur:i,onFocus:c,onKeyUp:u,onLoadItems:n,options:l,filteringType:p="auto",statusType:g="finished",placeholder:b,clearAriaLabel:y,name:O,disabled:w,disableBrowserAutocorrect:A=!1,autoFocus:x,readOnly:P,ariaLabel:v,ariaRequired:E,enteredTextLabel:k,filteringResultsText:B,onKeyDown:H,virtualScroll:V,expandToViewport:te,onSelect:oe,renderHighlightedAriaLive:ne,__internalRootRef:W}=e,I=ee(e,["value","onChange","onBlur","onFocus","onKeyUp","onLoadItems","options","filteringType","statusType","placeholder","clearAriaLabel","name","disabled","disableBrowserAutocorrect","autoFocus","readOnly","ariaLabel","ariaRequired","enteredTextLabel","filteringResultsText","onKeyDown","virtualScroll","expandToViewport","onSelect","renderHighlightedAriaLive","__internalRootRef"]);Qe("Autosuggest","value",t,"onChange",h),ze("Autosuggest","options",l);const T=m.useRef(null);m.useImperativeHandle(o,()=>({focus:()=>{var d;return(d=T.current)===null||d===void 0?void 0:d.focus()},select:()=>{var d;return(d=T.current)===null||d===void 0?void 0:d.select()}}),[]);const S=Pe("autosuggest"),z=S("errorIconAriaLabel",I.errorIconAriaLabel),$=S("selectedAriaLabel",I.selectedAriaLabel),re=S("recoveryText",I.recoveryText);I.recoveryText&&!n&&Te("Autosuggest","`onLoadItems` must be provided for `recoveryText` to be displayed.");const[C,L]=et({options:l||[],filterValue:t,filterText:t,filteringType:p,enteredTextLabel:k,hideEnteredTextLabel:!1,onSelectItem:d=>{var ue;const we=d.value||"";_(h,{value:we}),_(oe,{value:we,selectedOption:d.type!=="use-entered"?d.option:void 0}),(ue=T.current)===null||ue===void 0||ue.close()}}),M=Xe({options:l,statusType:g,onLoadItems:d=>_(n,d)}),U=d=>{L.setShowAll(!1),L.resetHighlightWithKeyboard(),_(h,d.detail)},N=d=>{M.fireLoadMoreOnInputChange(d.detail.value)},R=()=>{_(i,null)},Q=()=>{L.setShowAll(!0),M.fireLoadMoreOnInputFocus(),_(c,null)},K=d=>{ge(u,d.detail,d)},j=d=>{ge(H,d.detail,d)},se=()=>{if(C.items.length-1===C.highlightedIndex){L.goHomeWithKeyboard();return}L.moveHighlightWithKeyboard(1)},ie=()=>{var d;if(((d=C.highlightedOption)===null||d===void 0?void 0:d.type)==="child"&&C.highlightedIndex===1||C.highlightedIndex===0){L.goEndWithKeyboard();return}L.moveHighlightWithKeyboard(-1)},q=()=>L.selectHighlightedOptionWithKeyboard(),ae=()=>{L.resetHighlightWithKeyboard()},le=()=>{var d;M.fireLoadMoreOnRecoveryClick(),(d=T.current)===null||d===void 0||d.focus()},de=Ie(I),ce=Z("input"),J=Z("footer"),X=(a=de.controlId)!==null&&a!==void 0?a:ce,r=Z("list"),F=Z(),ve=C.highlightedOption?F:void 0,be=!t&&!C.items.length,me=!!t&&t.length!==0,Ke=me?B==null?void 0:B(C.items.length,(s=l==null?void 0:l.length)!==null&&s!==void 0?s:0):void 0,D=$e(Object.assign(Object.assign({},e),{isEmpty:be,isFiltered:me,recoveryText:re,errorIconAriaLabel:z,onRecoveryClick:le,filteringResultsText:Ke,hasRecoveryCallback:!!n})),ye=!be||!!D.content;return f.createElement(Je,Object.assign({},I,{className:xe(G.root,I.className),ref:T,__internalRootRef:W,value:t,onChange:U,onBlur:R,onFocus:Q,onKeyUp:K,onKeyDown:j,name:O,controlId:X,placeholder:b,disabled:w,readOnly:P,autoFocus:x,ariaLabel:v,ariaRequired:E,clearAriaLabel:y,disableBrowserAutocorrect:A,expandToViewport:te,ariaControls:r,ariaActivedescendant:ve,dropdownExpanded:ye,dropdownContent:ye&&f.createElement(it,{statusType:g,autosuggestItemsState:C,autosuggestItemsHandlers:L,highlightedOptionId:ve,highlightText:t,listId:r,controlId:X,handleLoadMore:M.fireLoadMoreOnScroll,hasDropdownStatus:D.content!==null,virtualScroll:V,selectedAriaLabel:$,renderHighlightedAriaLive:ne,listBottom:D.isSticky?null:f.createElement(Oe,{content:D.content,id:J}),ariaDescribedby:D.content?J:void 0}),dropdownFooter:D.isSticky&&D.content?f.createElement(Oe,{id:J,content:D.content,hasItems:C.items.length>=1}):null,loopFocus:D.hasRecoveryButton,onCloseDropdown:ae,onDelayedInput:N,onPressArrowDown:se,onPressArrowUp:ie,onPressEnter:q}))});export{it as A,ct as I,Xe as a,Je as b,G as c,et as u};
