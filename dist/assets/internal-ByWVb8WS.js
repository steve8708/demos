import{_ as Z,n as me,R as s,p as X,r as j,Y as He,O as pe,t as We,M as ge,w as ze,ax as be,m as Ke,o as ue,aC as Ye,az as Je}from"./index-WOunTE3s.js";import{O as Qe,c as Xe,i as Ze,u as et,a as tt,D as ye}from"./index-BKstH4kc.js";import{u as nt,p as it,a as st,c as lt,f as Q,F as ot,T as at,V as rt,P as ct}from"./use-select-C5da4KZ8.js";import{s as F,D as dt,u as ut,T as pt,t as Te}from"./dismiss-button-ESE9k303.js";import{c as gt}from"./index-CW5Ds-ha.js";function bt(d){var{ariaLabel:u,disabled:n,readOnly:p,dismissLabel:f,onDismiss:O,children:T}=d,A=Z(d,["ariaLabel","disabled","readOnly","dismissLabel","onDismiss","children"]);const L=me(A);return s.createElement("div",Object.assign({},L,{className:X(F.token,L.className),role:"group","aria-label":u,"aria-disabled":n}),s.createElement("div",{className:X(F["token-box"],n&&F["token-box-disabled"],p&&F["token-box-readonly"])},T,O&&s.createElement(dt,{disabled:n,dismissLabel:f,onDismiss:O,readOnly:p})))}function mt(d){var{alignment:u,items:n,onDismiss:p,limit:f,i18nStrings:O,disableOuterPadding:T,limitShowFewerAriaLabel:A,limitShowMoreAriaLabel:L,readOnly:R,__internalRootRef:v}=d,M=Z(d,["alignment","items","onDismiss","limit","i18nStrings","disableOuterPadding","limitShowFewerAriaLabel","limitShowMoreAriaLabel","readOnly","__internalRootRef"]);gt("TokenGroup","items",n,"onDismiss",p);const[a,c]=j.useState(null),S=ut({nextFocusIndex:a,onFocusMoved:l=>{l.focus(),c(null)},listItemSelector:`.${Te["list-item"]}`,showMoreSelector:`.${Te.toggle}`}),_=me(M),g=n.length>0,k=He(v,S);return s.createElement("div",Object.assign({},_,{className:X(_.className,F.root,g&&F["has-items"],T&&F["no-padding"]),ref:k}),s.createElement(pt,{alignment:u,items:n,limit:f,renderItem:(l,x)=>s.createElement(bt,Object.assign({ariaLabel:l.label,dismissLabel:l.dismissLabel,onDismiss:()=>{pe(p,{itemIndex:x}),c(x)},disabled:l.disabled,readOnly:R},l.disabled||R?{}:We({detail:{position:`${x+1}`}})),s.createElement(Qe,{option:l,isGenericGroup:!1})),i18nStrings:O,limitShowFewerAriaLabel:A,limitShowMoreAriaLabel:L,onExpandedClick:l=>{c(l&&f?f:null)}}))}function ht(d){var{options:u,filteringType:n,filteringResultsText:p,disabled:f,statusType:O,empty:T,loadingText:A,finishedText:L,errorText:R,noMatch:v,renderHighlightedAriaLive:M,selectedOptions:a,deselectAriaLabel:c,keepOpen:S,onBlur:_,onFocus:g,onLoadItems:k,onChange:l,controlId:x,ariaLabelId:ee,footerId:te,filteringValue:G,setFilteringValue:ne,externalRef:ie,embedded:q,enableSelectAll:B,i18nStrings:D}=d,w=Z(d,["options","filteringType","filteringResultsText","disabled","statusType","empty","loadingText","finishedText","errorText","noMatch","renderHighlightedAriaLive","selectedOptions","deselectAriaLabel","keepOpen","onBlur","onFocus","onLoadItems","onChange","controlId","ariaLabelId","footerId","filteringValue","setFilteringValue","externalRef","embedded","enableSelectAll","i18nStrings"]);Xe("Multiselect","options",u);const z=ge("multiselect"),U=ge("select"),$=U("recoveryText",w.recoveryText),C=U("errorIconAriaLabel",w.errorIconAriaLabel),E=U("selectedAriaLabel",w.selectedAriaLabel);w.recoveryText&&!k&&ze("Multiselect","`onLoadItems` must be provided for `recoveryText` to be displayed.");const{handleLoadMore:H,handleRecoveryClick:se,fireLoadItems:t}=nt({onLoadItems:k,options:u,statusType:O}),K=!0,{flatOptions:le,filteredOptions:b,parentMap:oe,totalCount:ae,matchesCount:re}=it(u,n,G),y={type:"select-all",afterHeader:n!=="none",option:{label:z("i18nStrings.selectAllText",D==null?void 0:D.selectAllText)}},P=B&&b.length?[y,...b]:b,Y=le.filter(e=>e.type!=="parent").map(e=>e.option),o=b.filter(e=>e.type!=="parent").map(e=>e.option),W=j.useMemo(()=>new Set(a.map(e=>e.value)),[a]),N=a.length>0,ke=N&&o.every(e=>e.disabled||W.has(e.value)),xe=Y.every(e=>W.has(e.value)),Pe=()=>{const e=new Set(o.map(i=>i.value));pe(l,{selectedOptions:ke?a.filter(i=>!e.has(i.value)):Y.filter(({disabled:i,value:m})=>W.has(m)||!i&&e.has(m))})},he=j.useCallback(e=>{const i=r=>r.every(h=>Q(a,h)>-1||h.disabled),m=(r,h)=>r.filter(V=>Q(h,V)>-1&&!V.disabled),$e=(r,h)=>r.filter(V=>Q(h,V)===-1).concat(h),Se=(r,h)=>$e(h,r),we=(r,h)=>h.filter(V=>Q(r,V)===-1);let I=[...a];if(Ze(e)){const r=m([...e.options],o);I=i(r)?we(r,I):Se(r,I)}else I=i([e])?we([e],I):Se([e],I);pe(l,{selectedOptions:I})},[a,l,o]),ce=j.useRef(null),{isOpen:fe,highlightType:Ie,highlightedOption:J,highlightedIndex:de,getTriggerProps:Oe,getDropdownProps:Fe,getFilterProps:Re,getMenuProps:Me,getOptionProps:_e,highlightOption:De,announceSelected:Ce}=st({selectedOptions:a,updateSelectedOption:he,options:P,filteringType:n,onFocus:g,onBlur:_,externalRef:ie,keepOpen:S,fireLoadItems:t,setFilteringValue:ne,useInteractiveGroups:K,statusType:O,embedded:q,isAllSelected:xe,isSomeSelected:N,toggleAll:Pe}),Ee=lt({isEnabled:n==="none"&&fe,options:P,highlightOption:De,highlightedOption:J==null?void 0:J.option,useInteractiveGroups:K}),Ne=!u||u.length===0,Ve=b&&b.length===0,Le=n!=="none"&&G.length>0&&b&&b.length>0,je=Le?p==null?void 0:p(re,ae):void 0,ve=et({statusType:O,empty:T,loadingText:A,finishedText:L,errorText:R,recoveryText:$,isEmpty:Ne,isNoMatch:Ve,noMatch:v,isFiltered:Le,filteringResultsText:je,onRecoveryClick:se,errorIconAriaLabel:C,hasRecoveryCallback:!!k}),Ge=tt({announceSelected:Ce,highlightedOption:J,getParent:e=>{var i;return(i=oe.get(e))===null||i===void 0?void 0:i.option},selectedAriaLabel:E,renderHighlightedAriaLive:M}),qe=a.map(e=>({label:e.label,disabled:f||e.disabled,labelTag:e.labelTag,description:e.description,iconAlt:e.iconAlt,iconName:e.iconName,iconUrl:e.iconUrl,iconSvg:e.iconSvg,tags:e.tags,dismissLabel:z("deselectAriaLabel",c==null?void 0:c(e),i=>{var m;return i({option__label:(m=e.label)!==null&&m!==void 0?m:""})})}));j.useEffect(()=>{var e;(e=ce.current)===null||e===void 0||e.call(ce,de)},[de]);const Be=e=>{e.target!==document.activeElement&&e.preventDefault()},Ue=({detail:e})=>{const i=a[e.itemIndex];he(i);const m=Oe().ref;m.current&&m.current.focus()};return{isOpen:fe,tokens:qe,announcement:Ge,dropdownStatus:ve,filteringValue:G,filteredOptions:P,highlightType:Ie,scrollToIndex:ce,getFilterProps:Re,getTriggerProps:Oe,getMenuProps:()=>Object.assign(Object.assign({},Me()),{onLoadMore:H,ariaLabelledby:be(ee,x),ariaDescribedby:ve.content?te:void 0,embedded:q}),getOptionProps:_e,getTokenProps:()=>({onDismiss:Ue}),getDropdownProps:()=>Object.assign(Object.assign({},Fe()),{onMouseDown:Be}),getWrapperProps:()=>({onKeyDown:Ee}),highlightedIndex:de}}const Ae={root:"awsui_root_f8g6q_4xhtp_145",embedded:"awsui_embedded_f8g6q_4xhtp_177",tokens:"awsui_tokens_f8g6q_4xhtp_210"},wt=s.forwardRef((d,u)=>{var n,{options:p,filteringType:f,filteringPlaceholder:O,filteringAriaLabel:T,filteringClearAriaLabel:A,ariaRequired:L,placeholder:R,disabled:v,readOnly:M,ariaLabel:a,selectedOptions:c,deselectAriaLabel:S,tokenLimit:_,i18nStrings:g,virtualScroll:k,inlineTokens:l=!1,hideTokens:x,expandToViewport:ee,tokenLimitShowFewerAriaLabel:te,tokenLimitShowMoreAriaLabel:G,__internalRootRef:ne=null,autoFocus:ie,enableSelectAll:q}=d,B=Z(d,["options","filteringType","filteringPlaceholder","filteringAriaLabel","filteringClearAriaLabel","ariaRequired","placeholder","disabled","readOnly","ariaLabel","selectedOptions","deselectAriaLabel","tokenLimit","i18nStrings","virtualScroll","inlineTokens","hideTokens","expandToViewport","tokenLimitShowFewerAriaLabel","tokenLimitShowMoreAriaLabel","__internalRootRef","autoFocus","enableSelectAll"]);const D=me(B),w=Ke(B),z=ge("multiselect"),U=ue("trigger"),$=(n=w.controlId)!==null&&n!==void 0?n:U,C=ue("multiselect-ariaLabel-"),E=ue("multiselect-footer-"),[H,se]=j.useState(""),t=ht(Object.assign({options:p,selectedOptions:c,filteringType:f,disabled:v,deselectAriaLabel:S,controlId:$,ariaLabelId:C,footerId:E,filteringValue:H,setFilteringValue:se,externalRef:u,enableSelectAll:q,i18nStrings:g},B)),K=s.createElement(ot,Object.assign({clearAriaLabel:A,filteringType:f,placeholder:O,ariaLabel:T,ariaRequired:L,value:H},t.getFilterProps())),le=s.createElement(at,Object.assign({placeholder:R,disabled:v,readOnly:M,triggerProps:t.getTriggerProps(v,ie),selectedOption:null,selectedOptions:c,triggerVariant:l?"tokens":"placeholder",isOpen:t.isOpen},w,{controlId:$,ariaLabelledby:be(w.ariaLabelledby,C)})),b=c.map(o=>({label:o.label,disabled:v||o.disabled,labelTag:o.labelTag,description:o.description,iconAlt:o.iconAlt,iconName:o.iconName,iconUrl:o.iconUrl,iconSvg:o.iconSvg,tags:o.tags,dismissLabel:z("deselectAriaLabel",S==null?void 0:S(o),W=>{var N;return W({option__label:(N=o.label)!==null&&N!==void 0?N:""})})})),oe=k?rt:ct,ae=!x&&!l&&b.length>0,re={limitShowFewer:g==null?void 0:g.tokenLimitShowFewer,limitShowMore:g==null?void 0:g.tokenLimitShowMore},y=t.dropdownStatus,P=t.getDropdownProps(),Y=t.filteredOptions.length>0;return s.createElement("div",Object.assign({},D,{ref:ne,className:X(Ae.root,D.className)},t.getWrapperProps()),s.createElement(Ye,Object.assign({},P,{ariaLabelledby:P.dropdownContentRole?be(C,$):void 0,ariaDescribedby:P.dropdownContentRole&&y.content?E:void 0,open:t.isOpen,trigger:le,header:K,footer:y.isSticky?s.createElement(ye,{content:t.isOpen?y.content:null,id:E}):null,expandToViewport:ee,stretchBeyondTriggerWidth:!0}),s.createElement(oe,{listBottom:y.isSticky?null:s.createElement(ye,{content:t.isOpen?y.content:null,id:E}),menuProps:t.getMenuProps(),getOptionProps:t.getOptionProps,filteredOptions:t.filteredOptions,filteringValue:H,ref:t.scrollToIndex,hasDropdownStatus:y.content!==null,checkboxes:!0,useInteractiveGroups:!0,screenReaderContent:t.announcement,highlightType:t.highlightType,firstOptionSticky:Y&&q})),ae&&s.createElement(mt,Object.assign({},t.getTokenProps(),{className:Ae.tokens,alignment:"horizontal",limit:_,items:b,i18nStrings:re,limitShowMoreAriaLabel:G,limitShowFewerAriaLabel:te,disableOuterPadding:!0,readOnly:M})),s.createElement(Je,{id:C},a))});export{wt as I,Ae as s,ht as u};
