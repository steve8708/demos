import{R as i,K as P,M as z,r as _,O as H,o as G,p as q,az as U,_ as K,n as Y,aT as J,Y as Q,b5 as X}from"./index-DWytQeHI.js";import{u as Z}from"./index-iaMOno-n.js";import{I as ee}from"./internal-MwMY9qEn.js";const s={"empty-appear":"awsui_empty-appear_n4qlp_vmmmm_153",root:"awsui_root_n4qlp_vmmmm_175",empty:"awsui_empty_n4qlp_vmmmm_153",row:"awsui_row_n4qlp_vmmmm_218",divider:"awsui_divider_n4qlp_vmmmm_222",field:"awsui_field_n4qlp_vmmmm_231","additional-info":"awsui_additional-info_n4qlp_vmmmm_235","add-row":"awsui_add-row_n4qlp_vmmmm_281","add-button":"awsui_add-button_n4qlp_vmmmm_285","remove-button-container":"awsui_remove-button-container_n4qlp_vmmmm_289","remove-button-field-padding":"awsui_remove-button-field-padding_n4qlp_vmmmm_293","remove-button-own-row":"awsui_remove-button-own-row_n4qlp_vmmmm_297","remove-button":"awsui_remove-button_n4qlp_vmmmm_289"},te=({children:n,id:e})=>i.createElement(P,{"data-testid":"info-live-region"},i.createElement("div",{id:e,className:s["additional-info"]},n)),ne={1:[{breakpoint:"xxs",rows:[[3]]},{rows:[[1]],removeButton:{ownRow:!0}}],2:[{breakpoint:"xs",rows:[[3,3]],removeButton:{width:2}},{breakpoint:"xxs",rows:[[1,1]],removeButton:{ownRow:!0}},{rows:[[1],[1]]}],3:[{breakpoint:"xs",rows:[[3,3,3]],removeButton:{width:3}},{breakpoint:"xxs",rows:[[1,1],[1]],removeButton:{ownRow:!0}},{rows:[[1],[1],[1]]}],4:[{breakpoint:"xs",rows:[[3,3,3,3]],removeButton:{width:4}},{breakpoint:"xxs",rows:[[1,1],[1,1]]},{rows:[[1],[1],[1],[1]]}],5:[{breakpoint:"s",rows:[[3,3,3,3,3]],removeButton:{width:5}},{breakpoint:"xs",rows:[[1,1,1],[1,1]]},{breakpoint:"xxs",rows:[[1,1],[1,1],[1]]},{rows:[[1],[1],[1],[1],[1]]}],6:[{breakpoint:"s",rows:[[3,3,3,3,3,3]],removeButton:{width:6}},{breakpoint:"xs",rows:[[1,1,1],[1,1,1]]},{breakpoint:"xxs",rows:[[1,1],[1,1],[1,1]]},{rows:[[1],[1],[1],[1],[1],[1]]}]};function oe(n,e){let o=0;for(const r of n.rows){let a=1;for(const t of r){if(o===e)return{gridColumnStart:a,gridColumnEnd:a+t};a+=t,o++}}return{gridColumnStart:1,gridColumnEnd:1}}function re(n,e){var o,r;const a=n.rows.reduce((t,m)=>Math.max(t,m.reduce((f,w)=>f+w,0)),0);if(j(n)){const t=typeof((o=n.removeButton)===null||o===void 0?void 0:o.width)=="number"?(r=n.removeButton)===null||r===void 0?void 0:r.width:1;return{gridColumnStart:e,gridColumnEnd:e+t}}return{gridColumnStart:1,gridColumnEnd:a+1}}function j(n){var e;return n.rows.length===1&&!(!((e=n.removeButton)===null||e===void 0)&&e.ownRow)}function ie(n){var e,o,r;const a=n.rows.reduce((m,f)=>Math.max(m,f.reduce((w,b)=>w+b,0)),0),t=j(n)?((e=n.removeButton)===null||e===void 0?void 0:e.width)==="auto"?"max-content":`${(r=(o=n.removeButton)===null||o===void 0?void 0:o.width)!==null&&r!==void 0?r:1}fr`:"";return`repeat(${a}, 1fr) ${t}`}function N(n,e,o){if(r(o))return o(n,e);return o;function r(a){return typeof a=="function"}}const ae=i.memo(({breakpoint:n,item:e,definition:o,layout:r,i18nStrings:a={},index:t,removable:m,removeButtonText:f,removeButtonRefs:w,customRowActions:b,onRemoveButtonClick:g,removeButtonAriaLabel:B})=>{var R;const T=z("attribute-editor"),l=_.useCallback(()=>{H(g,{itemIndex:t})},[g,t]),k=G("first-control-id-"),E=c=>{w[t]=c??void 0};let I=1,C=1;const v=j(r),h=b==null?void 0:b({item:e,itemIndex:t,ref:E,breakpoint:n,ownRow:!v});return i.createElement("div",{className:q(s.row,r.rows.length===1&&s["single-row"]),role:"group","aria-labelledby":`${k}-label ${k}`},o.map(({info:c,label:S,constraintText:A,errorText:x,warningText:y,control:O},p)=>({gridColumnStart:I,gridColumnEnd:C}=oe(r,p),i.createElement(ee,{key:p,className:s.field,__style:{gridColumnStart:I,gridColumnEnd:C},label:S,info:c,constraintText:N(e,t,A),errorText:N(e,t,x),warningText:N(e,t,y),stretch:!0,i18nStrings:{errorIconAriaLabel:a.errorIconAriaLabel,warningIconAriaLabel:a.warningIconAriaLabel},__hideLabel:t!==0&&v,controlId:p===0?k:void 0},N(e,t,O)))),i.createElement("div",{className:q(s["remove-button-container"],{[s["remove-button-field-padding"]]:v&&t===0,[s["remove-button-own-row"]]:!v}),style:Object.assign({},re(r,C))},m&&(h!==void 0?h:i.createElement(U,{className:s["remove-button"],formAction:"none",ref:E,ariaLabel:(R=B??a.removeButtonAriaLabel)===null||R===void 0?void 0:R(e),onClick:l},T("removeButtonText",f)))),!v&&i.createElement("div",{className:s.divider}))}),de=i.forwardRef((n,e)=>{var{additionalInfo:o,disableAddButton:r,definition:a=[{}],gridLayout:t,items:m,isItemRemovable:f=()=>!0,empty:w,addButtonText:b,addButtonVariant:g,removeButtonText:B,removeButtonAriaLabel:R,customRowActions:T,i18nStrings:l,onAddButtonClick:k,onRemoveButtonClick:E,__internalRootRef:I=null}=n,C=K(n,["additionalInfo","disableAddButton","definition","gridLayout","items","isItemRemovable","empty","addButtonText","addButtonVariant","removeButtonText","removeButtonAriaLabel","customRowActions","i18nStrings","onAddButtonClick","onRemoveButtonClick","__internalRootRef"]);const v=_.useRef([]),h=_.useRef(null),c=_.useRef(!1),[S,A]=_.useState(""),x=Y(C),y=m&&m.length===0;c.current=c.current||!y,_.useImperativeHandle(e,()=>({focusRemoveButton(u){var d;(d=v.current[u])===null||d===void 0||d.focus()},focusAddButton(){var u;(u=h.current)===null||u===void 0||u.focus()}}));const O=G("attribute-editor-info"),p=o?O:void 0,M=Z(m.length);i.useEffect(()=>{M&&M>m.length&&(l!=null&&l.itemRemovedAriaLive)?A(l.itemRemovedAriaLive):A("")},[m,l==null?void 0:l.itemRemovedAriaLive]),t||(t=ne[a.length],t||(console.warn("AttributeEditor","`gridLayout` is required for more than 6 attributes. Cannot render."),t=[]));const F=t.reduce((u,d)=>Object.assign(Object.assign({},u),{[d.breakpoint||"default"]:d}),{}),[$,V]=J(Object.keys(F)),W=Q(V,I),L=X(F,$||"default");if(!L)return console.warn("AttributeEditor",`No \`gridLayout\` entry found for breakpoint ${$}. Cannot render.`),i.createElement("div",null);const D=L.rows.reduce((u,d)=>u+d.length,0);return D!==a.length?(console.warn("AttributeEditor",`Incorrect number of columns in layout (${D}) for definition (${a.length}). Cannot render.`),i.createElement("div",null)):i.createElement("div",Object.assign({},x,{ref:W,className:q(x.className,s.root),style:{gridTemplateColumns:ie(L)}}),y&&i.createElement("div",{className:q(s.empty,c.current&&s["empty-appear"])},w),m.map((u,d)=>i.createElement(ae,{key:d,index:d,breakpoint:$,layout:L,item:u,definition:a,i18nStrings:l,removable:f(u),removeButtonText:B,removeButtonRefs:v.current,customRowActions:T,onRemoveButtonClick:E,removeButtonAriaLabel:R})),i.createElement("div",{className:s["add-row"]},i.createElement(U,{className:s["add-button"],disabled:r,__nativeAttributes:r?{tabIndex:-1}:{},__focusable:!0,onClick:k,formAction:"none",ref:h,ariaDescribedby:p,variant:g,iconName:g==="inline-link"?"add-plus":void 0},b),i.createElement(P,{"data-testid":"removal-announcement",tagName:"span",hidden:!0,delay:5,key:m.length},S),!!o&&i.createElement(te,{id:p},o)))});export{de as I};
