import{R as t,_ as j,n as q,r as s,M as U,N as $,O as H,P as E,Q,p as c,T as o,U as X,o as Y,V as Z,W as G,h as J,X as ee,Y as te,Z as se}from"./index-D7GDf1UU.js";import{R as re}from"./reset-contexts-for-modal-Cfc8SQi5.js";const le=t.forwardRef(ne);function ne(b,_){var{position:h="right",size:w="medium",fixedWidth:I=!1,triggerType:a="text",dismissButton:u=!0,children:v,header:k,content:A,triggerAriaLabel:T,wrapTriggerText:L=!0,isInline:N=!1,renderWithPortal:l=!1,__onOpen:x,__internalRootRef:D=null,__closeAnalyticsAction:W}=b,y=j(b,["position","size","fixedWidth","triggerType","dismissButton","children","header","content","triggerAriaLabel","wrapTriggerText","isInline","renderWithPortal","__onOpen","__internalRootRef","__closeAnalyticsAction"]);const C=q(y),r=s.useRef(null),O=s.useRef(null),d=s.useRef(null),B=U("popover")("dismissAriaLabel",y.dismissAriaLabel),[p,i]=s.useState(!1),f=s.useCallback(()=>{var e,n;["text","text-inline"].includes(a)?(e=r.current)===null||e===void 0||e.focus():r.current&&((n=$(r.current))===null||n===void 0||n.focus())},[a]),F=s.useCallback(()=>{H(x),i(!0)},[x]),P=s.useCallback(()=>{i(!1),f()},[f]),K=s.useCallback(e=>{const n=e.keyCode===E.escape,S=e.keyCode===E.tab;n&&p&&e.stopPropagation(),(S||n)&&i(!1)},[p]);s.useImperativeHandle(_,()=>({dismissPopover:P,focus:()=>{i(!1),f()}})),s.useEffect(()=>{if(!r.current)return;const e=r.current.ownerDocument,n=()=>{d.current===null&&i(!1)};return e.addEventListener("mousedown",n),()=>{e.removeEventListener("mousedown",n)}},[]);const M=Q(r),m={ref:r,onClick:F,onKeyDown:K,className:c(o.trigger,o[`trigger-type-${a}`])},{tabIndex:V}=X(r),g=Y(),R=t.createElement("div",{"aria-live":u?void 0:"polite","aria-atomic":u?void 0:!0,className:c(M,!l&&o["popover-inline-content"]),"data-awsui-referrer-id":g},t.createElement(Z,{size:w,fixedWidth:I,position:h,trackRef:r,arrow:e=>t.createElement(G,{position:e}),renderWithPortal:l,zIndex:l?7e3:void 0},t.createElement(J.Provider,{value:{defaultVariant:"primary"}},t.createElement(ee,{dismissButton:u,dismissAriaLabel:B,header:k,onDismiss:P,overflowVisible:"both",closeAnalyticsAction:W},A)))),z=te(O,D);return t.createElement("span",Object.assign({},C,{className:c(o.root,C.className,a==="filtering-token"&&o["root-filtering-token"],N&&o["no-wrap"]),ref:z,onMouseDown:()=>{d.current=requestAnimationFrame(()=>{d.current=null})}}),["text","text-inline"].includes(a)?t.createElement("button",Object.assign({},m,{className:c(m.className,L===!1&&o["overflow-ellipsis"]),tabIndex:V,type:"button","aria-haspopup":"dialog",id:g,"aria-label":T}),v):t.createElement("span",Object.assign({},m,{id:g}),v),p&&t.createElement(re,null,l?t.createElement(se,null,R):R))}export{le as I};
