import{u as G,R as r,c as X,_ as q,m as fe,n as ge,r as c,b9 as be,ba as _e,bb as xe,bc as we,p as j,ay as Ne,O as P,aA as Z,aB as ve,j as o,C as ye,S as Ie,I as De,B as U,L as Ee,H as Ae}from"./index-WOunTE3s.js";import{A as Ce}from"./index-BajTrzV7.js";import{E as Be}from"./index-DoriUEK6.js";import{I as Re,u as Se}from"./use-files-dragging-DiWjLgZK.js";import{I as je}from"./internal-DfaiPS43.js";import{M as Pe,F as ke}from"./messages-DBMbtRpv.js";import"./apply-mode-BcR-LfXG.js";import{FittedContainer as Fe,ScrollableContainer as Le}from"./common-components-4zXDJmON.js";import{getInitialMessages as Te,responseList as Ve,fileTokenGroupI18nStrings as He,validLoadingPrompts as Me,getLoadingMessage as ee,VALID_PROMPTS as te,getInvalidPromptResponse as Oe,supportPromptItems as $e,supportPromptMessageOne as ze,supportPromptMessageTwo as Ke}from"./config-BzT_Bi1S.js";import"./internal-CkJ_o5nI.js";import"./internal-DeB20z8e.js";import"./is-development-CxJkH8d1.js";import"./index-CW5Ds-ha.js";import"./jsx-runtime-B82SaG9X.js";import"./use-merge-refs-C2n6l-yF.js";import"./internal-D5cEm-R0.js";import"./dismiss-button-ESE9k303.js";import"./internal-CN81xZnG.js";import"./format-date-B0wWljPd.js";import"./index-Ix6OTFrh.js";import"./feedback-dialog-CwHc6a4C.js";import"./index-FwUIgwRI.js";import"./index-BDVmXg8N.js";import"./internal-Bv3_FbQY.js";import"./index-03PDySys.js";import"./index-DKI-yI3n.js";import"./dialog-BZ3dtQXx.js";import"./local-storage-JknLDoWi.js";import"./index-D-NGCnrk.js";import"./index-DL1yZozt.js";import"./index-BcmkS9Hv.js";import"./index-C9Utq3Wg.js";import"./internal-Bi51hpqb.js";import"./reset-contexts-for-modal-D_VDNU7Q.js";import"./index-J2rj9I77.js";import"./index-BwbDen41.js";function ae(g){const x=G("FileDropzone");return r.createElement(Re,Object.assign({},x,g))}X(ae,"FileDropzone");const oe=r.forwardRef((g,x)=>{var{multiple:p,variant:w}=g,b=q(g,["multiple","variant"]);const h=G("FileInput",{props:{multiple:p,variant:w}});return r.createElement(je,Object.assign({multiple:p,variant:w},b,h,{ref:x}))});X(oe,"FileInput");const n={root:"awsui_root_55fkh_196u9_146","textarea-readonly":"awsui_textarea-readonly_55fkh_196u9_185",disabled:"awsui_disabled_55fkh_196u9_190","textarea-invalid":"awsui_textarea-invalid_55fkh_196u9_198","textarea-warning":"awsui_textarea-warning_55fkh_196u9_223",textarea:"awsui_textarea_55fkh_196u9_185",invalid:"awsui_invalid_55fkh_196u9_323",warning:"awsui_warning_55fkh_196u9_323","textarea-wrapper":"awsui_textarea-wrapper_55fkh_196u9_342",button:"awsui_button_55fkh_196u9_346","action-button":"awsui_action-button_55fkh_196u9_351","secondary-content":"awsui_secondary-content_55fkh_196u9_376","with-paddings":"awsui_with-paddings_55fkh_196u9_411","secondary-actions":"awsui_secondary-actions_55fkh_196u9_421",buffer:"awsui_buffer_55fkh_196u9_474"},k={root:"awsui_root_nr3gs_n93je_5",textarea:"awsui_textarea_nr3gs_n93je_9","action-button":"awsui_action-button_nr3gs_n93je_13","secondary-actions":"awsui_secondary-actions_nr3gs_n93je_17","secondary-content":"awsui_secondary-content_nr3gs_n93je_21"},Ue=r.forwardRef((g,x)=>{var{value:p,actionButtonAriaLabel:w,actionButtonIconName:b,actionButtonIconUrl:h,actionButtonIconSvg:I,actionButtonIconAlt:C,ariaLabel:N,autoComplete:l,autoFocus:y,disableActionButton:D,disableBrowserAutocorrect:E,disabled:u,maxRows:A,minRows:F,name:H,onAction:L,onBlur:T,onChange:M,onFocus:R,onKeyDown:t,onKeyUp:s,placeholder:f,readOnly:i,spellcheck:v,secondaryActions:m,secondaryContent:a,disableSecondaryActionsPaddings:O,disableSecondaryContentPaddings:se,__internalRootRef:ie=null}=g,W=q(g,["value","actionButtonAriaLabel","actionButtonIconName","actionButtonIconUrl","actionButtonIconSvg","actionButtonIconAlt","ariaLabel","autoComplete","autoFocus","disableActionButton","disableBrowserAutocorrect","disabled","maxRows","minRows","name","onAction","onBlur","onChange","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","spellcheck","secondaryActions","secondaryContent","disableSecondaryActionsPaddings","disableSecondaryContentPaddings","__internalRootRef"]);const{ariaLabelledby:re,ariaDescribedby:ce,controlId:le,invalid:B,warning:V}=fe(W),J=ge(W),d=c.useRef(null),ue=be(d)==="compact",$=we,z=_e,me=3;c.useImperativeHandle(x,()=>({focus(...e){var _;(_=d.current)===null||_===void 0||_.focus(...e)},select(){var e;(e=d.current)===null||e===void 0||e.select()},setSelectionRange(...e){var _;(_=d.current)===null||_===void 0||_.setSelectionRange(...e)}}),[d]);const de=e=>{Z(t,e),e.key==="Enter"&&!e.shiftKey&&("form"in e.target&&e.target.form!==null&&!e.isDefaultPrevented()&&e.target.form.requestSubmit(),e.preventDefault(),P(L,{value:p}))},pe=e=>{P(M,{value:e.target.value}),S()},Q=b||I||h,S=c.useCallback(()=>{if(d.current){d.current.style.height="auto";const e=`calc(${z} +  ${xe} * 2)`;if(A===-1){const _=`calc(${d.current.scrollHeight}px)`;d.current.style.height=`max(${_}, ${e})`}else{const _=`calc(${A<=0?me:A} * (${z} + ${$} / 2) + ${$})`,he=`calc(${d.current.scrollHeight}px)`;d.current.style.height=`min(max(${he}, ${e}), ${_})`}}},[A,z,$]);c.useEffect(()=>{const e=()=>{S()};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[S]),c.useEffect(()=>{S()},[p,S,A,ue]);const K={"aria-label":N,"aria-labelledby":re,"aria-describedby":ce,"aria-invalid":B?"true":void 0,name:H,placeholder:f,autoFocus:y,className:j(n.textarea,k.textarea,{[n.invalid]:B,[n.warning]:V}),autoComplete:ve(l),spellCheck:v,disabled:u,readOnly:i?!0:void 0,rows:F,onKeyDown:de,onKeyUp:s&&(e=>Z(s,e)),value:p||"",onChange:pe,onBlur:T&&(()=>P(T)),onFocus:R&&(()=>P(R))};E&&(K.autoCorrect="off",K.autoCapitalize="off");const Y=r.createElement("div",{className:n.button},r.createElement(Ne,{className:j(n["action-button"],k["action-button"]),ariaLabel:w,disabled:u||i||D,__focusable:i,iconName:b,iconUrl:h,iconSvg:I,iconAlt:C,onClick:()=>P(L,{value:p}),variant:"icon"}));return r.createElement("div",Object.assign({},J,{"aria-label":N,className:j(n.root,k.root,J.className,{[n["textarea-readonly"]]:i,[n["textarea-invalid"]]:B,[n["textarea-warning"]]:V&&!B,[n.disabled]:u}),ref:ie,role:"region"}),a&&r.createElement("div",{className:j(n["secondary-content"],k["secondary-content"],{[n["with-paddings"]]:!se,[n.invalid]:B,[n.warning]:V})},a),r.createElement("div",{className:n["textarea-wrapper"]},r.createElement("textarea",Object.assign({ref:d,id:le},K)),Q&&!m&&Y),m&&r.createElement("div",{className:j(n["secondary-actions"],k["secondary-actions"],{[n["with-paddings"]]:!O,[n.invalid]:B,[n.warning]:V})},m,r.createElement("div",{className:n.buffer,onClick:()=>{var e;return(e=d.current)===null||e===void 0?void 0:e.focus()}}),Q&&Y))}),ne=r.forwardRef((g,x)=>{var{autoComplete:p,autoFocus:w,disableBrowserAutocorrect:b,disableActionButton:h,spellcheck:I,readOnly:C,actionButtonIconName:N,minRows:l=1,maxRows:y=3}=g,D=q(g,["autoComplete","autoFocus","disableBrowserAutocorrect","disableActionButton","spellcheck","readOnly","actionButtonIconName","minRows","maxRows"]);const E=G("PromptInput",{props:{readOnly:C,autoComplete:p,autoFocus:w,disableBrowserAutocorrect:b,disableActionButton:h,spellcheck:I,actionButtonIconName:N,minRows:l,maxRows:y}});return r.createElement(Ue,Object.assign({readOnly:C,autoComplete:p,autoFocus:w,disableBrowserAutocorrect:b,disableActionButton:h,spellcheck:I,actionButtonIconName:N,minRows:l,maxRows:y},D,E,{ref:x}))});X(ne,"PromptInput");function Ct(){var R;const x=(t=!1)=>t?4e3:1500,[p,w]=c.useState(""),[b,h]=c.useState(!1),[I,C]=c.useState(!0),N=c.useRef(null),[l,y]=c.useState([]),D=c.useRef(null),[E,u]=c.useState([]),{areFilesDragging:A}=Se(),F=t=>{var v,m;let s;t.id==="typescript"&&(s=ze),t.id==="expand"&&(s=Ke);const i={type:"chat-bubble",authorId:"user-jane-doe",content:(v=$e.find(a=>a.id===t.id))==null?void 0:v.text,timestamp:new Date().toLocaleTimeString()};u(a=>[...a,i]),(m=D.current)==null||m.focus(),setTimeout(()=>{h(!0),u(a=>[...a,ee()]),setTimeout(()=>{u(a=>(a.splice(a.length-1,1,s),a)),h(!1)},x())},300)},H=(t,s)=>{u(f=>{const i=[...f],v={...f[t],showFeedbackDialog:s};return i.splice(t,1,v),i})},L=(R=E[E.length-1])==null?void 0:R.content;c.useEffect(()=>{u(Te(F))},[]),c.useEffect(()=>{setTimeout(()=>{N.current&&(N.current.scrollTop=N.current.scrollHeight)},0)},[L]);const T=({detail:{value:t}})=>{if(!t&&l.length===0||t.length===0&&l.length===0||b)return;const s={type:"chat-bubble",authorId:"user-jane-doe",content:t,timestamp:new Date().toLocaleTimeString(),files:l};let f=l;u(m=>[...m,s]),w(""),y([]);const i=t.toLowerCase(),v=Me.includes(i);setTimeout(()=>{h(!0),u(m=>[...m,ee()]),setTimeout(()=>{const m=f.length>0?te.find(({prompt:a})=>a.includes("file")):te.find(({prompt:a})=>a.includes(i));u(a=>{const O=m?m.getResponse(F):Oe();return a.splice(a.length-1,1,O),a}),h(!1),f=[]},x(v))},300)},M=(t,s)=>{u(f=>{const i=[...f];return i.splice(t,0,s),i})};return o.jsxDEV("div",{className:"chat-container false",children:[I&&o.jsxDEV(Ce,{dismissible:!0,statusIconAriaLabel:"Info",onDismiss:()=>C(!1),children:o.jsxDEV(Be,{variant:"inline",headerText:`This demo showcases how to use generative AI components to build a generative AI chat. The interactions and
          functionality are limited.`,children:Ve},void 0,!1,{fileName:"/app/code/src/pages/chat/chat.tsx",lineNumber:177,columnNumber:11},this)},void 0,!1,{fileName:"/app/code/src/pages/chat/chat.tsx",lineNumber:176,columnNumber:9},this),o.jsxDEV(Fe,{children:o.jsxDEV(ye,{header:o.jsxDEV(Ae,{variant:"h3",children:"Generative AI chat"},void 0,!1,{fileName:"/app/code/src/pages/chat/chat.tsx",lineNumber:189,columnNumber:19},this),fitHeight:!0,disableContentPaddings:!0,footer:o.jsxDEV(o.Fragment,{children:[o.jsxDEV(ne,{ref:D,onChange:({detail:t})=>w(t.value),onAction:T,value:p,actionButtonAriaLabel:b?"Send message button - suppressed":"Send message",actionButtonIconName:"send",ariaLabel:b?"Prompt input - suppressed":"Prompt input",placeholder:"Ask a question",autoFocus:!0,disableSecondaryActionsPaddings:!0,secondaryActions:o.jsxDEV(U,{padding:{left:"xxs",top:"xs"},children:o.jsxDEV(oe,{ariaLabel:"Chat demo file input",variant:"icon",multiple:!0,value:l,onChange:({detail:t})=>y(s=>[...s,...t.value])},void 0,!1,{fileName:"/app/code/src/pages/chat/chat.tsx",lineNumber:210,columnNumber:21},this)},void 0,!1,{fileName:"/app/code/src/pages/chat/chat.tsx",lineNumber:209,columnNumber:19},this),secondaryContent:A?o.jsxDEV(ae,{onChange:({detail:t})=>y(s=>[...s,...t.value]),children:o.jsxDEV(Ie,{size:"xs",alignItems:"center",children:[o.jsxDEV(De,{name:"upload"},void 0,!1,{fileName:"/app/code/src/pages/chat/chat.tsx",lineNumber:223,columnNumber:25},this),o.jsxDEV(U,{children:"Drop files here"},void 0,!1,{fileName:"/app/code/src/pages/chat/chat.tsx",lineNumber:224,columnNumber:25},this)]},void 0,!0,{fileName:"/app/code/src/pages/chat/chat.tsx",lineNumber:222,columnNumber:23},this)},void 0,!1,{fileName:"/app/code/src/pages/chat/chat.tsx",lineNumber:221,columnNumber:21},this):l.length>0&&o.jsxDEV(ke,{items:l.map(t=>({file:t})),onDismiss:({detail:t})=>{var s;y(f=>f.filter((i,v)=>v!==t.fileIndex)),l.length===1&&((s=D.current)==null||s.focus())},limit:3,alignment:"horizontal",showFileThumbnail:!0,i18nStrings:He},void 0,!1,{fileName:"/app/code/src/pages/chat/chat.tsx",lineNumber:229,columnNumber:23},this)},void 0,!1,{fileName:"/app/code/src/pages/chat/chat.tsx",lineNumber:197,columnNumber:15},this),o.jsxDEV(U,{color:"text-body-secondary",margin:{top:"xs"},fontSize:"body-s",children:["Use of this service is subject to the"," ",o.jsxDEV(Ee,{href:"#",external:!0,variant:"primary",fontSize:"inherit",children:"AWS Responsible AI Policy"},void 0,!1,{fileName:"/app/code/src/pages/chat/chat.tsx",lineNumber:248,columnNumber:17},this),"."]},void 0,!0,{fileName:"/app/code/src/pages/chat/chat.tsx",lineNumber:246,columnNumber:15},this)]},void 0,!0,{fileName:"/app/code/src/pages/chat/chat.tsx",lineNumber:193,columnNumber:13},this),children:o.jsxDEV(Le,{ref:N,children:o.jsxDEV(Pe,{messages:E,setShowFeedbackDialog:H,addMessage:M},void 0,!1,{fileName:"/app/code/src/pages/chat/chat.tsx",lineNumber:257,columnNumber:13},this)},void 0,!1,{fileName:"/app/code/src/pages/chat/chat.tsx",lineNumber:256,columnNumber:11},this)},void 0,!1,{fileName:"/app/code/src/pages/chat/chat.tsx",lineNumber:188,columnNumber:9},this)},void 0,!1,{fileName:"/app/code/src/pages/chat/chat.tsx",lineNumber:187,columnNumber:7},this)]},void 0,!0,{fileName:"/app/code/src/pages/chat/chat.tsx",lineNumber:174,columnNumber:5},this)}export{Ct as default};
